<!DOCTYPE html>
<html lang="en">
    <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="theme-color" content="#00aeef" />
  <meta http-equiv="Content-Language" content="en" />

  <!-- Enable responsiveness on mobile devices-->
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
     3DS 2.0 Authentication &middot; Documentações e tutoriais 
  </title>

  <link rel="shortcut icon" href="https://developercielo.github.io/en/assets/favicon.ico" />

  <!-- CSS -->
  <link
    href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,500"
    rel="stylesheet"
    media="none"
    onload="if(media!='all')media='all'"
  />
  <script async src="https://use.fontawesome.com/3ae06f1030.js"></script>

  <link
    rel="stylesheet"
    href="https://developercielo.github.io/en/assets/bundles/css/bundle.min.css"
  />

   
  <link
    rel="alternate"
    hreflang="pt"
    href="https://developercielo.github.io/en/manual/3ds"
  />
    
  <link
    rel="alternate"
    hreflang="en"
    href="https://developercielo.github.io/en/en/manual/3ds"
  />
   

  <!-- RSS -->
  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="https://developercielo.github.io/en/atom.xml"
  />
</head>

    <body>
        
        <div class="content-container">
            <div class="language-tabs">
                <a class='hide-btn' id="hide-button" title="Toggle"><i class="fa fa-bars" aria-hidden="true"></i></a>
                <ul class="language-buttons">
                    
                    <li><a data-language-name='json'>JSON</a></li>
                    
                    <li><a data-language-name='shell'>cURL</a></li>
                    
                </ul>
            </div>
            <div class="dark-box"></div>
            <div class="overlay"></div>
        
            <div id="submenu">
                <div class="submenu-container">
                    <div class="submenu-row sub-items">
                        <div class="submenu-itens">
                            <a href="https://devcielo.zendesk.com/hc/pt-br#suporte" class="help">Help</a>

                            
                            <div class="lang">
                                <span>Languages</span>

                                
                                    
                                    <a href="https://developercielo.github.io/manual/3ds">
                                    

                                        <img alt="Português" src="https://developercielo.github.io/en/assets/images/pt.png"/>
                                    </a>
                                
                                    
                                    <a href="https://developercielo.github.io/en/manual/3ds">
                                    

                                        <img alt="English" src="https://developercielo.github.io/en/assets/images/en.png"/>
                                    </a>
                                
                            </div>
                            
                        </div>

                        
                        <div class="search">
                            <input type="text" class="search" id="input-search">
                        </div>
                    </div>
                    <div class="submenu-row results">
                        <div class="search-results-container">
                            <ul class="search-results"></ul>
                        </div>
                    </div>
                        

                    <div class="submenu-row breads">
                        <ol class="breadcrumb">
                            
                            <li><a href="https://developercielo.github.io/en/">Home</a></li>
                            
                            
                            
                            
                                
                                    
                                    
                                    
                                    
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                            
                                
                                    
                                    <li class="active">&gt; <a href="https://developercielo.github.io/en/manual/3ds">3DS 2.0 Authentication</a></li>
                                    
                                
                            
                        </ol>
                    </div>
                </div>
            </div>

            <div class="post"><h1 id="3ds-20-authentication">3DS 2.0 Authentication</h1>

<h2 id="what-is-3ds-20">What is 3DS 2.0?</h2>

<p><strong>EMV 3DS</strong>, also known as <strong>3DS 2.0</strong> is an authentication technology developed by the payments industry in order to reduce the risk of fraud without harming the conversion rate. This new version analyzes several variables used as a criteria to determine the cardholder authencity, allowing in some cases decreased cardholder authentication interactions (challenges), without risking the merchant’s <em>Liability Shift</em>.</p>

<p><strong>Main benefits:</strong></p>

<ul>
  <li>Java Script integration;</li>
  <li>Possibility of "silent" authentication (challenge exemption)</li>
  <li>Minimize fraudulent transactions;</li>
</ul>

<p><strong>Key words:</strong> Credit and Debit Card Authentication, EMVCO, 3DS 2.0, Visa, Mastercard, E-Commerce</p>

<h2 id="who-is-able-to-use-the-3ds-20">Who is able to use the 3DS 2.0?</h2>

<p>3DS 2.0 is valid for all e-commerce transactions, whether debit, credit or prepaid. For segments that have a high rate of chargeback/fraud, the solution tends to be even more advantageous compared to the benefit of passing the liability shift to the issuing bank.</p>

<h2 id="what-is-required-to-use-3ds-20">What is required to use 3DS 2.0?</h2>

<p>The merchant must attend the below requirements to use 3DS 2.0:</p>

<ul>
  <li>API Cielo E-Commerce affiliation;</li>
  <li>Have 3DS 2.0 registration (request to E-commerce Support);</li>
  <li>Complete the technical integration of the authentication flow;</li>
  <li>Complete the technical integration of the authorization flow;</li>
</ul>

<aside class="notice">In case you implement the authentication process apart from Cielo (External Authentication), skip to the authorization step.</aside>

<h2 id="what-is-the-data-only---notification-only">What is the Data Only - Notification Only</h2>

<p><strong>What is it?</strong></p>

<p>Data Only is an optional field that can be used to contribute to the brand and issuer database, improving authentication performance.</p>

<p>Data Only can be used when the issuer does not perform authentication. In this case, if the Data only field was parameterized in the script, the brand will receive the parameterized data and share this information with the issuer. Over time, the issuer will have more transaction data for that card and the cardholder and will have more elements to perform authentication.</p>

<p><strong>How to use Data Only?</strong></p>

<p>Just parameterize <code class="language-plaintext highlighter-rouge">bpmpi_auth_notifyonly</code>. Authorization occurs in the same way as any [Authorization with Authentication].</p>

<p>To use Data Only, in <a href="https://braspag.github.io//manual/emv3ds#integra%C3%A7%C3%A3o-do-script-via-javascript">Integração do script</a> parameterize the field <code class="language-plaintext highlighter-rouge">bpmpi_auth_notifyonly</code> described in item <strong>Etapa de Autenticação – passo 3 – Mapeamento de classes</strong>.</p>

<p>In the Data Only model, additional 3DS 2.0 fields are mapped in the same way and sent to the brand, however, authentication is not requested</p>

<blockquote>
  <p><strong>Data Only</strong> is valid for Mastercard and Visa brands.<br />
<br />
For <strong>Data Only Mastercard, the ECI will always be 4</strong>;<br />
For <strong>Data Only Visa, the ECI will always be 7</strong>.</p>
</blockquote>

<p><strong>What is the benefit of using Data Only?</strong></p>

<ul>
  <li>There is no type of friction with the shopper, who won’t notice any changes;</li>
  <li>Improve conversion by enriching the issuer database.</li>
</ul>

<blockquote>
  <p><strong>Warning:</strong><br /></p>
  <ul>
    <li>In Data Only transactions, the risk of chargeback due to fraud remains with the merchant;<br /></li>
    <li>It is possible to use Antifraude in 3DS Authentication transactions with Data Only.</li>
  </ul>
</blockquote>

<h2 id="payment-flow-3ds-20--with-challenge">Payment Flow 3DS 2.0 | With challenge</h2>

<p><img src="https://desenvolvedores.cielo.com.br/api-portal/sites/default/files/images/pagamento-com-desafio-01_0_-_en.jpg" alt="Flow with challenge 01" />
<img src="https://desenvolvedores.cielo.com.br/api-portal/sites/default/files/images/pagamento-com-desafio-02_-_en.jpg" alt="Flow with challenge 02" /></p>

<ol>
  <li>The holder fills the card details at the checkout of the merchant.</li>
  <li>The merchant set the 3DS 2.0 solution from Cielo via script for authentication.</li>
  <li>Cielo’s 3DS 2.0 solution sends the buyer’s information to the MPI (authentication platform).</li>
  <li>MPI communicates with the card brand to process the authentication. The brand identifies the issuer of the card, and sends the buyer’s information for analysis. The issuer identifies the holder as a possible risk, then, requires the challenge and returns the Authentication URL.</li>
  <li>A card brand returns an authentication URL to MPI.</li>
  <li>MPI returns the authentication URL to the 3DS 2.0 solution.</li>
  <li>The 3DS 2.0 solution return the authentication URL to the merchant via script.</li>
  <li>The script shows the authentication screen via lightbox.</li>
  <li>The holder solve the challenge on the issuer screen.</li>
  <li>The issuer returns the authentication result to the card brand.</li>
  <li>The card brand return the authentication result to the MPI.</li>
  <li>The MPI return the authentication result to the 3DS 2.0 solution.</li>
  <li>The 3DS 2.0 solution return the authentication result to the merchant via script (CAVV, ECI e XID).</li>
  <li>The merchant sends an authentication request with the authentication data to the API Cielo 3.0.</li>
  <li>The API Cielo 3.0 returns the authentication result to the merchant.</li>
  <li>The merchant notifies the payment result.</li>
</ol>

<h2 id="payment-flow-3ds-20--without-challenge">Payment Flow 3DS 2.0 | Without challenge</h2>

<p><img src="https://desenvolvedores.cielo.com.br/api-portal/sites/default/files/images/pagamento-sem-desafio_-_en.jpg" alt="Flow without challenge" /></p>

<ol>
  <li>The holder fills the card details at the checkout of the merchant.</li>
  <li>The merchant set the 3DS 2.0 solution from Cielo via script for authentication.</li>
  <li>Cielo’s 3DS 2.0 solution sends the buyer’s information to the MPI (authentication platform).</li>
  <li>MPI communicates with the card brand to process the authentication. The brand identifies the issuer of the card, and sends the buyer’s information for analysis. The issuer identifies the holder as a possible risk, then, requires the challenge and returns the Authentication URL.</li>
  <li>The card brand returns the silent authentication result (CAVV e ECI).</li>
  <li>The MPI returns the silent authentication result to the 3DS 2.0 solution.</li>
  <li>The 3DS 2.0 solution returns the silent authentication result to the merchant via script.</li>
  <li>The merchant sends an authentication request with the authentication data to the API Cielo 3.0.</li>
  <li>The API Cielo 3.0 returns the authentication result to the merchant.</li>
  <li>The merchant notifies the payment result.</li>
</ol>

<h2 id="how-does-the-authenticated-authorization-via-3ds-20-work">How does the authenticated authorization via 3DS 2.0 work?</h2>

<p>The authorization process using authentication through 3DS 2.0 occurs in two steps:</p>

<ol>
  <li>Authentication</li>
  <li>Authorization</li>
</ol>

<p>The steps below describes the detailed process:</p>

<p><img src="https://developercielo.github.io/images/fluxo-env3ds-eng.jpg" alt="Fluxo 3DS 2.0" /></p>

<ol>
  <li>Cardholder choose to pay with credit or debit card.</li>
  <li>Merchant requests authentication through Cielo solution.</li>
  <li>Authentication platform can perform two ways: request cardholder authentication or perform the authentication silently. In the first case, the platform will return the Authentication URL to the merchant. In the second case, the next step is already is the return with the authentication result.</li>
  <li>Merchant presents the authentication interface on <em>lightbox</em> (Issuer Authentication URL).</li>
  <li>The cardholder authenticates in the issuer (process known as <strong>complete the challenge</strong> process)</li>
  <li>Card issuer returns authentication result to 3DS platform, which pass it back to the merchant.</li>
  <li>Merchant decides if they want to go ahead with authorization process. Once they decide to go ahead, the authentication result must be submitted with the authorization.</li>
  <li>Cielo returns the authorization result to the merchant, which passes it to the cardholder.</li>
</ol>

<h2 id="eci-e-commerce-indicator">ECI (E-commerce Indicator)</h2>

<p>The E-Commerce Indicator (ECI) is returned in the authentication process. This code is an indicator of what exactly occurred in the transaction authentication process.</p>

<p>Through ECI, it can be verified whether the transaction was authenticated and who was the agent responsible for that authentication. Check out the <a href="https://developercielo.github.io/manual/3ds#eci-(e-commerce-indicator)">ECI table</a>.</p>

<h1 id="3ds-integration-via-javascript">3DS Integration via Javascript</h1>

<h2 id="step-1-access-token-request">STEP 1. Access Token Request</h2>

<p>The solution is composed by the access token request via the API and authentication request via Java Script.</p>

<table>
  <thead>
    <tr>
      <th>Environment</th>
      <th>Endpoint</th>
      <th>Authorization</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>SANDBOX</strong></td>
      <td>https://mpisandbox.braspag.com.br</td>
      <td><strong>Basic <em>(Authorization)</em></strong><br />The Authorization must be generated concatenating “ClientID”, colon character (“:”) and “ClientSecret”<br />Ex. dba3a8db-fa54-40e0-8bab-7bfb9b6f2e2e:D/ilRsfoqHlSUChwAMnlyKdDNd7FMsM7cU/vo02REag=<br />after this, encode the result in base 64. <br />Then, this will generate an alphanumeric code that will be used in the access token request. For test purposes, use the following data:<br />ClientID: <strong>dba3a8db-fa54-40e0-8bab-7bfb9b6f2e2e</strong><br />ClientSecret: <strong>D/ilRsfoqHlSUChwAMnlyKdDNd7FMsM7cU/vo02REag=</strong></td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><strong>PRODUCTION</strong></td>
      <td>https://mpi.braspag.com.br</td>
      <td>Please contact our support team to generate the “ClientID” and “ClientSecret” after integrating on sandbox environment.</td>
    </tr>
  </tbody>
</table>

<h3 id="request">Request</h3>

<aside class="request"><span class="method post">POST</span> <span class="endpoint">/v2/auth/token</span></aside>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"EstablishmentCode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1006993069"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"MerchantName"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Loja Exemplo Ltda"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"MCC"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5912"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl
<span class="nt">--request</span> POST <span class="s2">"https://mpisandbox.braspag.com.br/v2/auth/token"</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--header</span> <span class="s2">"Authorization: Basic xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
<span class="nt">--data-binary</span>
<span class="nt">--verbose</span>
<span class="o">{</span>
     <span class="s2">"EstablishmentCode"</span>:<span class="s2">"1006993069"</span>,
     <span class="s2">"MerchantName"</span>: <span class="s2">"Loja Exemplo Ltda"</span>,
     <span class="s2">"MCC"</span>: <span class="s2">"5912"</span>
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th><strong>Parameter</strong></th>
      <th><strong>Description</strong></th>
      <th><strong>Type</strong></th>
      <th><strong>Size</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>EstablishmentCode</td>
      <td>Cielo E-commerce 3.0 affiliation code</td>
      <td>Numeric</td>
      <td>10</td>
    </tr>
    <tr>
      <td>MerchantName</td>
      <td>Merchant Name as registered on Cielo</td>
      <td>Alphanumeric</td>
      <td>Max 25</td>
    </tr>
    <tr>
      <td>MCC</td>
      <td>Merchant category code</td>
      <td>Numeric</td>
      <td>4</td>
    </tr>
  </tbody>
</table>

<h2 id="response">Response</h2>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjbGllbnRfbmFtZSI6IlFBXzNEU19BdXRoZW50aWNhdG9yIiwiY2xpZW50X2lkIjoiZGJhM2E4ZGItZmE1NC00MGUwLThiYWItN2JmYjliNmYyZTJlIiwic2NvcGVzIjoie1wiU2NvcGVcIjpcIjNEU0F1dGhlbnRpY2F0b3JcIixcIkNsYWltc1wiOlt7XCJOYW1lXCI6XCJNZXJjaGFudE5hbWVcIixcIlZhbHVlc1wiOFwiVmFsdWVzXCI6W1wiNTU1NVwiXX0se1wiTmFtZVwiOlwiUmVmZXJlbmNlSWRcIixcIlZhbHVlc1wiOltcImY3MjE1YmQ3LWM0OTQtNGQ5Yi1NzEyfQ.daMqXko3dZOV0TzNFQ2vSsVSKqOsrwuswg7RB82ecAASSSSSSSSSSSSFFFFFFFFFFFFFGGGGGGGGGGGGGGGGGGGGGGGG"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"token_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"barear"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"expires_in"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-07-23T11:29:32"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--data-binary</span>
<span class="o">{</span>
      <span class="s2">"access_token"</span>: <span class="s2">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJjbGllbnRfbmFtZSI6IlFBXzNEU19BdXRoZW50aWNhdG9yIiwiY2xpZW50X2lkIjoiZGJhM2E4ZGItZmE1NC00MGUwLThiYWItN2JmYjliNmYyZTJlIiwic2NvcGVzIjoie1wiU2NvcGVcIjpcIjNEU0F1dGhlbnRpY2F0b3JcIixcIkNsYWltc1wiOlt7XCJOYW1lXCI6XCJNZXJjaGFudE5hbWVcIixcIlZhbHVlc1wiOFwiVmFsdWVzXCI6W1wiNTU1NVwiXX0se1wiTmFtZVwiOlwiUmVmZXJlbmNlSWRcIixcIlZhbHVlc1wiOltcImY3MjE1YmQ3LWM0OTQtNGQ5Yi1NzEyfQ.daMqXko3dZOV0TzNFQ2vSsVSKqOsrwuswg7RB82ecAASSSSSSSSSSSSFFFFFFFFFFFFFGGGGGGGGGGGGGGGGGGGGGGGG"</span>,
      <span class="s2">"token_type"</span>: <span class="s2">"barear"</span>,
      <span class="s2">"expires_in"</span>: <span class="s2">"2018-07-23T11:29:32"</span>
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th><strong>Parameter</strong></th>
      <th><strong>Description</strong></th>
      <th><strong>Type</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>access_token</td>
      <td>Token required to continue with authentication</td>
      <td>Alphanumeric</td>
    </tr>
    <tr>
      <td>token_type</td>
      <td>Fixed "Bearer"</td>
      <td>Alphanumeric</td>
    </tr>
    <tr>
      <td>expires_in</td>
      <td>Token expiration time (minutes)</td>
      <td>Numeric</td>
    </tr>
  </tbody>
</table>

<h2 id="step-2-script-implementation">STEP 2. Script implementation</h2>

<p>This step contains the <em>script</em> and the mapping of <em>classes</em> implementation responsable to comunicate with the authentication platform from brands and issuers. The example below shows the basic implementation. It is recommended that the snippet is placed at the end of the checkout HTML code:</p>

<blockquote>
  <p>To download the code, <a href="https://github.com/DeveloperCielo/developercielo.github.io/blob/docs/_i18n/pt/_posts/emv3ds/exemplo.html">Click here</a></p>
</blockquote>

<p><img src="https://developercielo.github.io/images/exemplo-html.jpg" alt="Script Example 3DS 2.0" /></p>

<h3 id="description-of-events">Description of Events</h3>

<p>The events are actions that the script considers as a response for following the authentication process, but do not indicate if the transaction was successfully authenticated.</p>

<p>The ECI (E-commerce Indicator) is what indicates if the transaction was authenticated or not and the liability in case of chargeback. In order to sumbit a transaction for authorization, please consider the ECI value and use the events only as a complemenatry information for decision-making.</p>

<aside class="warning">Submitting a non-authenticated transaction for authorization is allowed; however, the liability shift in case of chargeback remains with the merchant.</aside>

<table>
  <thead>
    <tr>
      <th><strong>Event</strong></th>
      <th><strong>Description</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>onReady</td>
      <td>This is triggered when the script is completely loaded, which includes validation of the access token, indicating that the checkout is ready to initiate authentication process</td>
    </tr>
    <tr>
      <td>onSuccess</td>
      <td>It is triggered when the card is elegible and the authentication process is successfully finished. In this case, the variables CAVV, XID and ECI are returned. These data must be sent in together with the authorization request. In this scenario, if the transaction is authorized, the liability shift is transferred to the issuer.</td>
    </tr>
    <tr>
      <td>onFailure</td>
      <td>It is triggered when the card is elegible but the authentication process failed for some reason. In this case, only ECI variable is returned. If the merchant decide to proceed with the authorization, the ECI must also be sent in the request. In this scenario if the transaction is authorized, the liability shift remains with the merchant.</td>
    </tr>
    <tr>
      <td>onUnenrolled</td>
      <td>It is triggered when the card is not elegible, in other words, the cardholder and/or issuer does not support the authentication program. In this case, guide the shopper to check with the issuer if the card is enabled to perform authentication in e-commerce. Only the ECI variable is returned. If the merchant decides to proceed with the authorization, the ECI must be sent together with the authorization. If the transaction is authorized, the liability shift remains with the merchant.</td>
    </tr>
    <tr>
      <td>onDisabled</td>
      <td>It is triggered when the merchant chooses not to submit the cardholder to the authentication process. ("bpmpi_auth" class set as false). In this scenario, if the transaction is authorized, the liability shift remains with the merchant.</td>
    </tr>
    <tr>
      <td>onError</td>
      <td>It is triggered when the authentication process receives a systemic error. In this scenario, if the transaction is authorized, the liability shift remains with the merchant.</td>
    </tr>
    <tr>
      <td>onUnsupportedBrand</td>
      <td>It is triggered when the card scheme is not supported by 3DS 2.0</td>
    </tr>
  </tbody>
</table>

<h2 id="description-of-request-parameters">Description of Request Parameters</h2>

<table>
  <thead>
    <tr>
      <th><strong>Parameter</strong></th>
      <th><strong>Description</strong></th>
      <th><strong>Type</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Environment</td>
      <td>Indicates the environment to be used (Sandbox or Production)</td>
      <td>String <br /><strong>SDB</strong> – <em>Sandbox (test environment)</em> <strong>PRD</strong> – <em>Production (production environment)</em></td>
    </tr>
    <tr>
      <td>Debug</td>
      <td>Boolean that identifies if debug mode is activated. When sent as true, the platform will generate the report on the browser’s debug mechanism.</td>
      <td>Boolean <br /><em>true<br />false</em></td>
    </tr>
  </tbody>
</table>

<p><strong>NOTE!</strong></p>

<p>The JavaScript file must be saved in the server where the merchant application is hosted. To download the file on Sandbox environment, access:</p>

<p><a href="https://bit.ly/2CSOp2n">https://bit.ly/2CSOp2n</a></p>

<p>Output Description</p>

<table>
  <thead>
    <tr>
      <th><strong>Output</strong></th>
      <th><strong>Description</strong></th>
      <th><strong>Type</strong></th>
      <th><strong>Size</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Cavv</td>
      <td>Authentication signature</td>
      <td>Text</td>
      <td>-</td>
    </tr>
    <tr>
      <td>Xid</td>
      <td>Authentication request ID</td>
      <td>Text</td>
      <td>-</td>
    </tr>
    <tr>
      <td>Eci</td>
      <td>E-commerce indicator code, which represents the authentication result</td>
      <td>Numeric</td>
      <td>Max 2</td>
    </tr>
    <tr>
      <td>Version</td>
      <td>3DS applied version</td>
      <td>Numeric</td>
      <td>1<br /> <strong>1.0</strong> = <em>3DS 1.0;</em> <br /><strong>2.0</strong> = <em>3DS 2.0;</em></td>
    </tr>
    <tr>
      <td>ReferenceId</td>
      <td>Authentication request ID</td>
      <td>GUID</td>
      <td>36</td>
    </tr>
    <tr>
      <td>ReturnCode</td>
      <td>Authentication return code</td>
      <td>Alphanumeric</td>
      <td>Max 5</td>
    </tr>
    <tr>
      <td>ReturnMessage</td>
      <td>Authentication result message</td>
      <td>Alphanumeric</td>
      <td>Variable</td>
    </tr>
  </tbody>
</table>

<h3 id="examples-for-script-output">Examples for script output</h3>

<p><strong>Example for event <code class="language-plaintext highlighter-rouge">OnSuccess</code></strong></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="err">Cavv:</span><span class="w"> </span><span class="err">'Y</span><span class="mi">2</span><span class="err">FyZGluYWxjb</span><span class="mi">21</span><span class="err">tZXJjZWF</span><span class="mi">1</span><span class="err">dGg='</span><span class="p">,</span><span class="w">
  </span><span class="err">Xid:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="err">Eci:</span><span class="w"> </span><span class="err">'</span><span class="mi">01</span><span class="err">'</span><span class="p">,</span><span class="w">
  </span><span class="err">Version:</span><span class="w"> </span><span class="err">'</span><span class="mi">2</span><span class="err">'</span><span class="p">,</span><span class="w">
  </span><span class="err">ReferenceId:</span><span class="w"> </span><span class="err">'</span><span class="mi">973</span><span class="err">cf</span><span class="mi">83</span><span class="err">d-b</span><span class="mi">378-43</span><span class="err">d</span><span class="mi">5-84</span><span class="err">b</span><span class="mi">6</span><span class="err">-ce</span><span class="mi">1531475</span><span class="err">f</span><span class="mi">2</span><span class="err">a'</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Example for event <code class="language-plaintext highlighter-rouge">OnFailure</code></strong></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="err">Xid:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="err">Eci:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="err">ReturnCode:</span><span class="w"> </span><span class="err">'</span><span class="mi">231</span><span class="err">'</span><span class="p">,</span><span class="w">
  </span><span class="err">ReturnMessage:</span><span class="w"> </span><span class="err">'Unexpected</span><span class="w"> </span><span class="err">error</span><span class="w"> </span><span class="err">ocurred'</span><span class="p">,</span><span class="w">
  </span><span class="err">ReferenceId:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p><strong>Example when card brand is not supported for authentication</strong></p>

<p>When tha card brand is not supported for 3DS, the MPI returns the code “MPI600” and the message <em>“Brand not supported for authentication”.</em></p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="err">Xid:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="err">Eci:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="err">ReturnCode:</span><span class="w"> </span><span class="err">'MPI</span><span class="mi">600</span><span class="err">'</span><span class="p">,</span><span class="w">
  </span><span class="err">ReturnMessage:</span><span class="w"> </span><span class="err">'Brand</span><span class="w"> </span><span class="err">not</span><span class="w"> </span><span class="err">supported</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">authentication'</span><span class="p">,</span><span class="w">
  </span><span class="err">ReferenceId:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Confira os valores possíveis de <code class="language-plaintext highlighter-rouge">ReturnCodes</code> na tabela <a href="https://developercielo.github.io/manual/3ds#lista-de-return-codes">Lista de Return Codes</a>.</p>

<h2 id="step-3-mapping-classes">STEP 3. Mapping Classes</h2>

<p>Classes that must be mapped in your HTML code.</p>

<p>Once the class is mapped to it’s given field, the script is able to retrieve the value contained in the field and submit it to compose the authentication request.</p>

<aside class="warning">The higher amount of fields parametrized, the higher is the chance of having a transparent authentication, since the issuer will have more data for the risk analysis.</aside>

<aside class="notice">The # character indicated in the field must be replaced by the number representing the item index. <br /> Example: bpmpi_item_1_productName' represents the first item of the cart.</aside>

<table>
  <thead>
    <tr>
      <th><strong>Data Category</strong></th>
      <th><strong>Field</strong></th>
      <th><strong>Description</strong></th>
      <th><strong>Type/Size</strong></th>
      <th><strong>Required</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Parameterization</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_auth</code></td>
      <td>Boolean indicating whether or not the transaction is submitted to the authentication process.</td>
      <td>Boolean: <br />true - submit to authentication<br />false - don’t subit to authentication</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Parameterization</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_auth_notifyonly</code></td>
      <td>Boolean indicating whether the card transaction will be submitted in “notification only” mode. In this mode, the authentication process will not be triggered, however, the data will be submitted to the flag. <strong>VALID ONLY FOR MASTERCARD CARDS</strong></td>
      <td>Boolean: <br />true - notification only mode;<br />false - authentication mode</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Parameterization</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_auth_suppresschallenge</code></td>
      <td>Boolean that indicates if ignore or not the challenge. If the challenge is ignored, the liability will keep with the merchant.</td>
      <td>Boolean: <br />true – ignore challenge <br />false – perform challenge</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Parameterization</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_accesstoken</code></td>
      <td>Token generated by Access Token API (step 1)</td>
      <td>Alphanumeric (variable)</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_ordernumber</code></td>
      <td>Merchant order number</td>
      <td>Alphanumeric [max 50 positions]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_currency</code></td>
      <td>Currency code</td>
      <td>Fixed “BRL”</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_totalamount</code></td>
      <td>Total transaction amount (cents)</td>
      <td>Numeric [max 15 positions]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_installments</code></td>
      <td>Number of Installments</td>
      <td>Numeric [max 2 positions]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_paymentmethod</code></td>
      <td>Card type to be authenticated. If the card has both functions, it is necessary to specify the transaction type.</td>
      <td>Credit - Credit Card<br />Debit - Debit Card</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cardnumber</code></td>
      <td>Card number</td>
      <td>Numeric [max 19 positions]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cardexpirationmonth</code></td>
      <td>Card expiration month</td>
      <td>Numeric [max 2 positions]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cardexpirationyear</code></td>
      <td>Card expiration year</td>
      <td>Numeric [max 4 positions]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cardalias</code></td>
      <td>Card alias</td>
      <td>Alphanumeric [max 128 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_default_card</code></td>
      <td>Indicates whether it is a standard customer card in the e-commerce</td>
      <td>Boolean<br />true - yes<br />false - no</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_enddate</code></td>
      <td>End date of recurrency</td>
      <td>Text (AAAA-MM-DD)</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_frequency</code></td>
      <td>Frequency of recurrency</td>
      <td>Number<br />1 - Monthly<br />2 - Bimonthly<br />3 - Quarterly<br />4 - Four Monthly<br />6 - Semester<br />12 - Annual</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_originalpurchasedate</code></td>
      <td>Date of first transaction that orignated the recurrency</td>
      <td>Text (AAAA-MM-DD)</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_order_recurrence</code></td>
      <td>Indicates whether it is an order that generates future recurrences</td>
      <td>Boolean<br />true<br />false</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_order_productcode</code></td>
      <td>Product Type</td>
      <td><strong>PHY</strong>: purchase Goods<br /><strong>CHA</strong>: Check acceptance<br /><strong>ACF</strong>: Account financing<br /><strong>QCT</strong>: Quasi-Cash Transaction <br /><strong>PAL</strong>: Prepaid Activation and Load<br /></td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_order_countlast24hours</code></td>
      <td>Number of orders placed by same customer in the last 24 hours</td>
      <td>Numeric [max 3 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_order_countlast6months</code></td>
      <td>Number of orders placed by same customer in the last 6 months</td>
      <td>Numeric [max 4 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_order_countlast1year</code></td>
      <td>Number of orders placed by same customer in the last year</td>
      <td>Numeric [max 3 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_order_cardattemptslast24hours</code></td>
      <td>Number of orders placed with the same card in the last 24 hours</td>
      <td>Numeric [max 3 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_order_marketingoptin</code></td>
      <td>Indicates whether the shopper accepted to receive marketing offers</td>
      <td>Boolean<br />true - yes<br />false - no</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_order_marketingsource</code></td>
      <td>Identifies the origin of the marketing campaign</td>
      <td>Alphanumeric [max 40 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_transaction_mode</code></td>
      <td>Identifies the channel from which the transaction originates</td>
      <td>M: MOTO<br />R: Varejo<br />S: E-Commerce<br />P: Mobile<br />T: Tablet</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Order Description</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_merchant_url</code></td>
      <td>Address of the e-commerce’s web site</td>
      <td>Alphanumeric [max 100 positions] Example: http://www.exemplo.com.br</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Prepaid cards</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_giftcard_amount</code></td>
      <td>The total purchase amount for prepaid gift cards in rounded value</td>
      <td>Numeric [max 15 positions],<br /> example: R$125,54 = 12554</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Prepaid cards</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_giftcard_currency</code></td>
      <td>Transaction currency code paid with prepaid type card</td>
      <td>Fixed “BRL”</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_customerid</code></td>
      <td>Identifies the CPF/CNPJ of customer</td>
      <td>Numeric [11 to 14 positions]<br />99999999999999</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_contactname</code></td>
      <td>Billing address contact name</td>
      <td>Alphanumeric [max 120 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_phonenumber</code></td>
      <td>Billing address phone number</td>
      <td>Numeric [max 15 positions], in the format: 5511999999999</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_email</code></td>
      <td>Billing address contact email</td>
      <td>Alphanumeric [max 255 positions], in the format <a href="mailto:name@example.com">name@example.com</a></td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_street1</code></td>
      <td>Street address and billing address number</td>
      <td>Alphanumeric [max 60 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_street2</code></td>
      <td>Neighborhood and complement billing address</td>
      <td>Alphanumeric [max 60 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_city</code></td>
      <td>Billing address city</td>
      <td>Alphanumeric [max 50 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_state</code></td>
      <td>Billing address state</td>
      <td>Text [2 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_zipcode</code></td>
      <td>Billing address zip code</td>
      <td>Alphanumeric [max 8 positions], in the format: 99999999</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Billing Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_billto_country</code></td>
      <td>Billing address country</td>
      <td>Text [2 positions] e.g., BR</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipto_sameasbillto</code></td>
      <td>Indicates it is the same address provided on the billing address</td>
      <td>Boolean<br />true<br />false</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipto_addressee</code></td>
      <td>Shipping address contact name</td>
      <td>Alphanumeric [max 60 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipTo_phonenumber</code></td>
      <td>Delivery address phone number</td>
      <td>Numeric [max 15 positions], in the format: 5511999999999</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipTo_email</code></td>
      <td>Delivery address contact email</td>
      <td>Alphanumeric [max 255 positions], in the format <a href="mailto:name@example.com">name@example.com</a></td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipTo_street1</code></td>
      <td>Street address and delivery address number</td>
      <td>Alphanumeric [max 60 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipTo_street2</code></td>
      <td>Neighborhood and complement delivery address</td>
      <td>Alphanumeric [max 60 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipTo_city</code></td>
      <td>Delivery address city</td>
      <td>Alphanumeric [max 50 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipTo_state</code></td>
      <td>Accuracy of delivery address state</td>
      <td>string [2 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipto_zipcode</code></td>
      <td>Delivery address zip code</td>
      <td>Alphanumeric [max 2 positions], in the format: 99999999</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipto_country</code></td>
      <td>Delivery address country</td>
      <td>Text [2 positions], e.g., BR</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipTo_shippingmethod</code></td>
      <td>Shipping method type</td>
      <td>lowcost<br />sameday<br />oneday<br />twoday<br />threeday<br />pickup<br />other</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Delivery Address</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_shipto_firstusagedate</code></td>
      <td>Indicates the date of first use of the delivery address</td>
      <td>Text<br />AAAA-MM-DD - criation date</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Shopping Cart</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cart_#_description</code></td>
      <td>Item description</td>
      <td>Alphanumeric [max 255 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Shopping Cart</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cart_#_name</code></td>
      <td>Item name</td>
      <td>Alphanumeric [max 255 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Shopping Cart</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cart_#_sku</code></td>
      <td>Item SKU</td>
      <td>Alphanumeric [max 255 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Shopping Cart</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cart_#_quantity</code></td>
      <td>Cart item quantity</td>
      <td>Numeric [max 10 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Shopping Cart</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_cart_#_unitprice</code></td>
      <td>Unit value of the cart item (cents)</td>
      <td>Numeric [max 10 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>User</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_useraccount_guest</code></td>
      <td>Indicates whether the customer is not logged (guest)</td>
      <td>Boolean<br />true - yes<br />false - no</td>
      <td>No</td>
    </tr>
    <tr>
      <td>User</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_useraccount_createddate</code></td>
      <td>Indicates the account creation date</td>
      <td>String<br />AAAA-MM-DD - creation date</td>
      <td>No</td>
    </tr>
    <tr>
      <td>User</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_useraccount_changeddate</code></td>
      <td>Indicates the last change date of shopper’s account</td>
      <td>String<br />AAAA-MM-DD - last alteration date</td>
      <td>No</td>
    </tr>
    <tr>
      <td>User</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_useraccount_passwordchangeddate</code></td>
      <td>Indicates the date when the shopper’s account password changed</td>
      <td>Text<br />AAAA-MM-DD - date of the last password change</td>
      <td>No</td>
    </tr>
    <tr>
      <td>User</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_useraccount_authenticationmethod</code></td>
      <td>Shopper’s authentication method</td>
      <td>01 - <em>No authentication</em><br />02 - <em>Store login</em><br />03 - <em>Login with federated ID</em><br />04 - <em>Login with FIDO authenticator</em></td>
      <td>No</td>
    </tr>
    <tr>
      <td>User</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_useraccount_authenticationprotocol</code></td>
      <td>Data that represents the login protocol carried out in the store</td>
      <td>Alphanumeric [max 2048 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>User</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_useraccount_authenticationtimestamp</code></td>
      <td>The date and time the store was logged in</td>
      <td>String [max 19 positions]<em>YYYY-MM-ddTHH:mm:ss</em></td>
      <td>No</td>
    </tr>
    <tr>
      <td>User</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_merchant_newcustomer</code></td>
      <td>Indicates whether the consumer is a new or existing customer with the merchant</td>
      <td>Boolean<br />true – yes<br />false – no</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Device</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_device_ipaddress</code></td>
      <td>IP address of the shopper’s machine</td>
      <td>Alphanumeric [max 45 positions]</td>
      <td>Conditional - required for Visa only</td>
    </tr>
    <tr>
      <td>Device</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_device_#_fingerprint</code></td>
      <td>Id returned by Device Fingerprint</td>
      <td>Alphanumeric [no limit]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Device</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_device_#_provider</code></td>
      <td>Device Fingerprint provider name</td>
      <td>Alphanumeric [max 32 positions] cardinal<br />inauth<br />threatmetrix</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Device</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_device_#_channel</code></td>
      <td>Channel from which the transaction came from. Possible values:<br />-Browser<br />-SDK<br />-3RI</td>
      <td>Alphanumeric [up to 7 positions]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><strong>Recurrence</strong></td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_type</code></td>
      <td>Recurring payment type.</td>
      <td>Number<br />1 - First transaction <br />2 - Subsequent transaction <br />3 - Modification <br />4-Cancellation</td>
      <td>No</td>
    </tr>
    <tr>
      <td><strong>Recurrence</strong></td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_validationIndicator</code></td>
      <td>Indicates whether the recurring payment transaction was validated or not.</td>
      <td>Number<br />0 - Not validated <br />1 - Validated</td>
      <td>No</td>
    </tr>
    <tr>
      <td><strong>Recurrence</strong></td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_maximumAmount</code></td>
      <td>Maximum amount agreed by the cardholder.</td>
      <td>numeric [up to 12 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td><strong>Recurrence</strong></td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_referenceNumber</code></td>
      <td>Unique reference number for the recurring payment transaction.</td>
      <td>Alphanumeric [up to 35 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td><strong>Recurrence</strong></td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_occurrence</code></td>
      <td>Indicates how often a recurring payment occurs.</td>
      <td>Number<br />01 - Daily<br />02 - Twice a week<br />03 - Weekly<br />04 - Every ten days<br />05 - Fortnightly <br />06- Monthly<br />07 - Bimonthly<br />08 - Every three months<br />09 - Every four months<br />10 - Every six months<br />11 - Annually <br />12 - Unscheduled.</td>
      <td>No</td>
    </tr>
    <tr>
      <td><strong>Recurrence</strong></td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_numberOfPayments</code></td>
      <td>Total number of payments during the recurring subscription.</td>
      <td>Number [up to 2 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td><strong>Recurrence</strong></td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_recurring_amountType</code></td>
      <td>Indicates the type of recurring amount agreed by the cardholder.</td>
      <td>Supported values:<br />1 - Recurring payment of fixed value<br />2 - Recurring payment with maximum value.</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_travelleg_#_carrier</code></td>
      <td>IATA code for the stretch</td>
      <td>Alphanumeric [2 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_travelleg_#_departuredate</code></td>
      <td>Departure date</td>
      <td>String<br />AAAA-MM-DD</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_travelleg_#_origin</code></td>
      <td>IATA code from origin airport</td>
      <td>Alphanumeric [5 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_travelleg_#_destination</code></td>
      <td>IATA code from destination airport</td>
      <td>Alphanumeric [5 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_passenger_#_name</code></td>
      <td>Passenger name</td>
      <td>Alphanumeric [max 60 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_passenger_#_ticketprice</code></td>
      <td>Ticket price (cents)</td>
      <td>Numeric [max 15 positions],<br />example:R$125,54 = 12554</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_numberofpassengers</code></td>
      <td>Passenger number</td>
      <td>Numeric [3 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_billto_passportcountry</code></td>
      <td>Code of the country that emitted the passport (ISO Standard Country Codes)</td>
      <td>Text [2 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Airlines</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_airline_billto_passportnumber</code></td>
      <td>Passport number</td>
      <td>Alphanumeric [40 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Merchant Defined Data</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_mdd1</code></td>
      <td>Extra data defined by the merchant</td>
      <td>Alphanumeric [max 255 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Merchant Defined Data</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_mdd2</code></td>
      <td>Extra data defined by the merchant</td>
      <td>Alphanumeric [max 255 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Merchant Defined Data</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_mdd3</code></td>
      <td>Extra data defined by the merchant</td>
      <td>Alphanumeric [max 255 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Merchant Defined Data</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_mdd4</code></td>
      <td>Extra data defined by the merchant</td>
      <td>Alphanumeric [max 255 positions]</td>
      <td>No</td>
    </tr>
    <tr>
      <td>Merchant Defined Data</td>
      <td><code class="language-plaintext highlighter-rouge">bpmpi_mdd5</code></td>
      <td>Extra data defined by the merchant</td>
      <td>Alphanumeric [max 255 positions]</td>
      <td>No</td>
    </tr>
  </tbody>
</table>

<h2 id="step-4-implementing-authentication-request">STEP 4. Implementing authentication request</h2>

<p>The "<strong>bpmpi_Authenticate()</strong>" event must be requested when finishing the checkout(finishing the order). Example:</p>

<p>&lt;input type="button"onclick="bpmpi_authenticate()" /&gt;</p>

<h2 id="eci-e-commerce-indicator-1">ECI (E-commerce Indicator)</h2>

<p>The ECI (Electronic Commerce Indicator) is a code returned by the brands and indicates the result of the cardholder’s 3DS authentication with the issuer or brand. Check the ECIs corresponding to each flag and the authentication result in the table below.</p>

<blockquote>
  <p>Subsequently, the ECI value must be sent in the transaction request in the <code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.Eci</code> field</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Mastercard</th>
      <th>Visa</th>
      <th>Elo</th>
      <th>Amex</th>
      <th>Authentication result</th>
      <th>Was the transaction authenticated?</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>02</td>
      <td>05</td>
      <td>05</td>
      <td>05</td>
      <td>Authenticated by the issuer – chargeback risk goes to the issuer.</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>01</td>
      <td>06</td>
      <td>06</td>
      <td>06</td>
      <td>Authenticated by the issuer – chargeback risk goes to the issuer.</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td>Different than 01, 02 and 04</td>
      <td>Different than 05 and 06</td>
      <td>Different than 05 and 06</td>
      <td>Different than 05 and 06</td>
      <td>Not authenticated - chargeback risk remais with the merchant.</td>
      <td>No</td>
    </tr>
    <tr>
      <td>04</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>Not authenticated, transaction characterized as <em>Data Only</em> - chargeback risk remains with the merchant.</td>
      <td>No</td>
    </tr>
  </tbody>
</table>

<h2 id="card-numbers-for-test-purpose">Card Numbers for test Purpose</h2>

<p>Use the <strong>test</strong> cards below to simulate different scenarios in the <strong>SANDBOX</strong> environment</p>

<h2 id="test-cards-with-challenge">Test Cards with Challenge</h2>

<table>
  <thead>
    <tr>
      <th><strong>CARD</strong></th>
      <th><strong>FLAG</strong></th>
      <th><strong>RESULT</strong></th>
      <th><strong>DESCRIPTION</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4000000000001091<br />5200000000001096<br />6505290000001234</td>
      <td>VISA<br />MASTER<br />ELO</td>
      <td>SUCCESS</td>
      <td>Challenge authentication and bearer authenticated successfully</td>
    </tr>
    <tr>
      <td>4000000000001109<br />5200000000001104<br />6505050000001109</td>
      <td>VISA<br />MASTER<br />ELO</td>
      <td>FAILURE</td>
      <td>Challenged authentication and bearer authenticated failed</td>
    </tr>
    <tr>
      <td>4000000000001117<br />5200000000001112<br />6505050000001117</td>
      <td>VISA<br />MASTER<br />ELO</td>
      <td>UNENROLLED</td>
      <td>Challenge authentication currently unavailable</td>
    </tr>
    <tr>
      <td>4000000000001125<br />5200000000001120<br />6505050000001125</td>
      <td>VISA<br />MASTER<br />ELO</td>
      <td>UNENROLLED</td>
      <td>System error during authentication step</td>
    </tr>
  </tbody>
</table>

<h2 id="no-challenge-test-cards">No Challenge Test Cards</h2>

<table>
  <thead>
    <tr>
      <th><strong>CARD</strong></th>
      <th><strong>FLAG</strong></th>
      <th><strong>RESULT</strong></th>
      <th><strong>DESCRIPTION</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>4000000000001000<br />5200000000001005<br />6505050000001000</td>
      <td>VISA<br />MASTER<br />ELO</td>
      <td>SUCCESS</td>
      <td>Unchallenged authentication and bearer successfully authenticated</td>
    </tr>
    <tr>
      <td>4000000000001018<br />5200000000001013<br />6505050000001018</td>
      <td>VISA<br />MASTER<br />ELO</td>
      <td>FAILURE</td>
      <td>Unchallenged authentication and bearer authenticated failed</td>
    </tr>
  </tbody>
</table>

<h1 id="authorization-with-authentication">Authorization with Authentication</h1>

<p>After authentication is completed, submit to the authorization procedure, sending the authentication data in the model of quot;external authentication" (node <strong>ExternalAuthentication</strong> ).
This procedure is also valid for establishments that performed authentication outside Cielo (External MPI).</p>

<p>See example below, describing the Cielo E-commerce API authorization request authentication data:</p>

<aside class="request"><span class="method post">POST</span> <span class="endpoint">/1/sales</span></aside>

<h3 id="request-1">Request</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
   </span><span class="nl">"MerchantOrderId"</span><span class="p">:</span><span class="s2">"2017051002"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"Customer"</span><span class="p">:</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="err">(...)</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"Payment"</span><span class="p">:</span><span class="w">
   </span><span class="p">{</span><span class="w">
     </span><span class="err">(...)</span><span class="w">
     </span><span class="nl">"Authenticate"</span><span class="p">:</span><span class="kc">true</span><span class="p">,</span><span class="w">
     </span><span class="nl">"ReturnUrl"</span><span class="p">:</span><span class="s2">"http://www.loja.com.br"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"CreditCard"</span><span class="p">:{</span><span class="w">
         </span><span class="nl">"CardNumber"</span><span class="p">:</span><span class="s2">"4000000000001000"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"Holder"</span><span class="p">:</span><span class="s2">"Nome do Portador"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"ExpirationDate"</span><span class="p">:</span><span class="s2">"12/2021"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"SecurityCode"</span><span class="p">:</span><span class="s2">"123"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"Brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"SaveCard"</span><span class="p">:</span><span class="s2">"false"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="nl">"ExternalAuthentication"</span><span class="p">:{</span><span class="w">
       </span><span class="nl">"Cavv"</span><span class="p">:</span><span class="s2">"AAABB2gHA1B5EFNjWQcDAAAAAAB="</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Xid"</span><span class="p">:</span><span class="s2">"Uk5ZanBHcWw2RjRCbEN5dGtiMTB="</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Eci"</span><span class="p">:</span><span class="s2">"5"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"Version"</span><span class="p">:</span><span class="s2">"2"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"ReferenceID"</span><span class="p">:</span><span class="s2">"a24a5d87-b1a1-4aef-a37b-2f30b91274e6"</span><span class="w">
     </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl
<span class="nt">--request</span> POST <span class="s2">"https://apisandbox.cieloecommerce.cielo.com.br/1/sales"</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--header</span> <span class="s2">"MerchantId: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
<span class="nt">--header</span> <span class="s2">"MerchantKey: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
<span class="nt">--data-binary</span>
<span class="nt">--verbose</span>
<span class="o">{</span>
   <span class="s2">"MerchantOrderId"</span>:<span class="s2">"2017051002"</span>,
   <span class="s2">"Customer"</span>:
   <span class="o">{</span>
     <span class="o">(</span>...<span class="o">)</span>
   <span class="o">}</span>,
   <span class="s2">"Payment"</span>:
   <span class="o">{</span>
     <span class="o">(</span>...<span class="o">)</span>
     <span class="s2">"Authenticate"</span>:true,
     <span class="s2">"ReturnUrl"</span>:<span class="s2">"http://www.loja.com.br"</span>,
     <span class="s2">"CreditCard"</span>:<span class="o">{</span>
         <span class="s2">"CardNumber"</span>:<span class="s2">"4000000000001000"</span>,
         <span class="s2">"Holder"</span>:<span class="s2">"Nome do Portador"</span>,
         <span class="s2">"ExpirationDate"</span>:<span class="s2">"12/2021"</span>,
         <span class="s2">"SecurityCode"</span>:<span class="s2">"123"</span>,
         <span class="s2">"Brand"</span>:<span class="s2">"Visa"</span>,
         <span class="s2">"SaveCard"</span>:<span class="s2">"false"</span>
     <span class="o">}</span>,
     <span class="s2">"ExternalAuthentication"</span>:<span class="o">{</span>
       <span class="s2">"Cavv"</span>:<span class="s2">"AAABB2gHA1B5EFNjWQcDAAAAAAB="</span>,
       <span class="s2">"Xid"</span>:<span class="s2">"Uk5ZanBHcWw2RjRCbEN5dGtiMTB="</span>,
       <span class="s2">"Eci"</span>:<span class="s2">"5"</span>,
       <span class="s2">"Version"</span>:<span class="s2">"2"</span>,
       <span class="s2">"ReferenceId"</span>:<span class="s2">"a24a5d87-b1a1-4aef-a37b-2f30b91274e6"</span>
     <span class="o">}</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th><strong>Field</strong></th>
      <th><strong>Description</strong></th>
      <th><strong>Type/Size</strong></th>
      <th><strong>Required</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.Authenticate</code></td>
      <td>Boolean which defines whether the buyer will be directed to the issuing Bank for card authentication</td>
      <td>Boolean</td>
      <td>Yes, for authentication to be performed it is required to send as <code class="language-plaintext highlighter-rouge">true</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.Cavv</code></td>
      <td>Signature that is returned in authentication success scenarios</td>
      <td>Text</td>
      <td>Yes, when authentication was a success</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.Xid</code></td>
      <td>XID returned in authentication process</td>
      <td>Text</td>
      <td>Yes, when the 3DS version is "1"</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.Eci</code></td>
      <td>E-Commerce Indicator returned in authentication process</td>
      <td>Numeric [1 character]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.Version</code></td>
      <td>3DS version used in authentication process</td>
      <td>Alphanumeric [1 character]</td>
      <td>Yes, when the 3DS version is "2"</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.ReferenceId</code></td>
      <td>RequestID returned in authentication process</td>
      <td>GUID [36 characters]</td>
      <td>Yes, when the 3DS version is "2"</td>
    </tr>
  </tbody>
</table>

<h3 id="response-1">Response</h3>

<p>See <a href="https://developercielo.github.io/en/manual/cielo-ecommerce#response" target="_blank">Cielo E-commerce API</a> for the response.</p>

<h1 id="authorization-for-data-only-transactions">Authorization for Data Only Transactions</h1>

<p>After the authentication step in Data Only model is completed (field <code class="language-plaintext highlighter-rouge">bpmpi_auth_notifyonly</code> set as “true”), the transaction undergoes the authorization process by sending the authentication data in the “external authentication” model (node <code class="language-plaintext highlighter-rouge">ExternalAuthentication</code>).</p>

<p>See example below, describing the submission of authentication data from the Cielo E-commerce API authorization request, using POST:</p>

<h3 id="request-2">Request</h3>

<aside class="request"><span class="method post">POST</span> <span class="endpoint">/1/sales</span></aside>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">  
   </span><span class="nl">"MerchantOrderId"</span><span class="p">:</span><span class="s2">"2017051002"</span><span class="p">,</span><span class="w">
   </span><span class="nl">"Customer"</span><span class="p">:</span><span class="w">
   </span><span class="p">{</span><span class="w">  
     </span><span class="err">(...)</span><span class="w">
   </span><span class="p">},</span><span class="w">
   </span><span class="nl">"Payment"</span><span class="p">:</span><span class="w">
   </span><span class="p">{</span><span class="w">  
     </span><span class="err">(...)</span><span class="w">
     </span><span class="nl">"Authenticate"</span><span class="p">:</span><span class="kc">false</span><span class="p">,</span><span class="w">
     </span><span class="nl">"ReturnUrl"</span><span class="p">:</span><span class="s2">"http://www.loja.com.br"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"CreditCard"</span><span class="p">:{</span><span class="w">  
         </span><span class="nl">"CardNumber"</span><span class="p">:</span><span class="s2">"4000000000001000"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"Holder"</span><span class="p">:</span><span class="s2">"Nome do Portador"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"ExpirationDate"</span><span class="p">:</span><span class="s2">"12/2027"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"SecurityCode"</span><span class="p">:</span><span class="s2">"123"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"Brand"</span><span class="p">:</span><span class="s2">"Visa"</span><span class="p">,</span><span class="w">
         </span><span class="nl">"SaveCard"</span><span class="p">:</span><span class="s2">"false"</span><span class="w">
     </span><span class="p">},</span><span class="w">
     </span><span class="nl">"ExternalAuthentication"</span><span class="p">:{</span><span class="w">
       </span><span class="nl">"Eci"</span><span class="p">:</span><span class="s2">"4"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"ReferenceID"</span><span class="p">:</span><span class="s2">"a24a5d87-b1a1-4aef-a37b-2f30b91274e6"</span><span class="p">,</span><span class="w">
       </span><span class="nl">"dataonly"</span><span class="p">:</span><span class="kc">true</span><span class="w">
     </span><span class="p">}</span><span class="w">
   </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">--request</span> POST <span class="s2">"https://apisandbox.cieloecommerce.cielo.com.br/1/sales"</span>
<span class="nt">--header</span> <span class="s2">"Content-Type: application/json"</span>
<span class="nt">--header</span> <span class="s2">"MerchantId: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
<span class="nt">--header</span> <span class="s2">"MerchantKey: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>
<span class="nt">--data-binary</span>
<span class="nt">--verbose</span>
<span class="o">{</span>  
   <span class="s2">"MerchantOrderId"</span>:<span class="s2">"2017051002"</span>,
   <span class="s2">"Customer"</span>:
   <span class="o">{</span>  
     <span class="o">(</span>...<span class="o">)</span>
   <span class="o">}</span>,
   <span class="s2">"Payment"</span>:
   <span class="o">{</span>  
     <span class="o">(</span>...<span class="o">)</span>
     <span class="s2">"Authenticate"</span>:false,
     <span class="s2">"ReturnUrl"</span>:<span class="s2">"http://www.loja.com.br"</span>,
     <span class="s2">"CreditCard"</span>:<span class="o">{</span>  
         <span class="s2">"CardNumber"</span>:<span class="s2">"4000000000001000"</span>,
         <span class="s2">"Holder"</span>:<span class="s2">"Nome do Portador"</span>,
         <span class="s2">"ExpirationDate"</span>:<span class="s2">"12/2027"</span>,
         <span class="s2">"SecurityCode"</span>:<span class="s2">"123"</span>,
         <span class="s2">"Brand"</span>:<span class="s2">"Visa"</span>,
         <span class="s2">"SaveCard"</span>:<span class="s2">"false"</span>
     <span class="o">}</span>,
     <span class="s2">"ExternalAuthentication"</span>:<span class="o">{</span>
       <span class="s2">"Eci"</span>:<span class="s2">"4"</span>,
       <span class="s2">"ReferenceID"</span>:<span class="s2">"a24a5d87-b1a1-4aef-a37b-2f30b91274e6"</span>,
       <span class="s2">"dataonly"</span>:true
     <span class="o">}</span>
   <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th><strong>FIELD</strong></th>
      <th><strong>DESCRIPTION</strong></th>
      <th><strong>TYPE/SIZE</strong></th>
      <th><strong>REQUIRED</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.Authenticate</code></td>
      <td>Defines if the buyer will be directed to the issuing Bank for card authentication</td>
      <td>Boolean (true or false)</td>
      <td>Yes. For Data Only transactions the value must be “false”</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.Eci</code></td>
      <td><em>E-commerce Indicator</em> returned in authentication process</td>
      <td>Numeric [1 position]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.ReferenceId</code></td>
      <td>RequestID returned in authentication process</td>
      <td>GUID [36 positions]</td>
      <td>Yes</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">Payment.ExternalAuthentication.DataOnly</code></td>
      <td>Defines if transaction is <em>Data Only</em></td>
      <td>Boolean (true or false)</td>
      <td>Yes. For Data Only transactions the value must be “true”</td>
    </tr>
  </tbody>
</table>

<h3 id="response-2">Response</h3>

<p>See <a href="https://developercielo.github.io/manual/cielo-ecommerce#resposta42" target="_blank">Cielo E-commerce API</a> for detailed examples of Authorization with Authentication response.</p>
</div>


            <div class="footer-conteudo">
  <div id="footer-conteudo-img" class="col-lg-1 col-md-1">
    <img
      src="https://developercielo.github.io/en/assets/images/icon-doubt.svg"
      width="55px"
      height="53px"
      alt="Need Help?"
    />
  </div>

  <div id="footer-conteudo-texto" class="col-lg-11 col-md-11">
    <h2>Need Help?</h2>
    <p>If you didn't find your answer, <a href="https://devcielo.zendesk.com/hc/pt-br#suporte">send us a message</a>.</p>
  </div>
</div>

        </div>

        <div class="sidebar">
  <div class="sidebar-sticky">
    <div class="sidebar-about">
      <a
        title="Toggle left column"
        class="hamburger"
      >
        <i class="fa fa-bars hamb-menu" aria-hidden="true"></i>
      </a>
      <a href="https://desenvolvedores.cielo.com.br" target="_blank">
        <img
          src="https://developercielo.github.io/en/assets/images/logo.png"
          alt="Documentações e tutoriais"
          style="width: 60%; margin-left: 20%"
        />
      </a>
      <div></div>
    </div>

    <div id="toc"></div>

    <div class="fixed-footer">
      

      <div class="toc-contact">
        <div class="contact">
          <a
            title="Contact"
            href="https://devcielo.zendesk.com/"
          >
            <i class="fa fa-envelope-o" aria-hidden="true"></i>
            <span>Contact</span>
          </a>
        </div>
        <div class="github">
          <a title="GitHub" href="https://github.com/developercielo">
            <i class="fa fa-github" aria-hidden="true"></i>
            <span>GitHub</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>


        <script src="https://developercielo.github.io/en/assets/bundles/js/bundle.min.js"></script>
        <script>
            
            var selectors = 'h1,h2,h3,h4,h5,h6';
            
        </script>

        
        <script src="https://developercielo.github.io/en/assets/bundles/js/search.min.js"></script>
        

        
        <script>
            let langs = '';
            let langsArray = [];

            
            langs += "<a data-language-name='json'>JSON</a>";
            langsArray.push('json');
            
            langs += "<a data-language-name='shell'>cURL</a>";
            langsArray.push('shell');
            

            var toggleCode = 'Toggle';
        </script>

        <script src='https://developercielo.github.io/en/assets/bundles/js/language_buttons.min.js'></script>
        

        <!-- Hotjar Tracking Code for https://developercielo.github.io/ -->
<script>
  (function (h, o, t, j, a, r) {
    h.hj =
      h.hj ||
      function () {
        (h.hj.q = h.hj.q || []).push(arguments);
      };
    h._hjSettings = { hjid: 674586, hjsv: 6 };
    a = o.getElementsByTagName("head")[0];
    r = o.createElement("script");
    r.async = 1;
    r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
    a.appendChild(r);
  })(window, document, "https://static.hotjar.com/c/hotjar-", ".js?sv=");
</script>

    </body>
</html>
