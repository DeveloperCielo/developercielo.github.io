<!DOCTYPE html>
<html lang="pt">
    <head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="theme-color" content="#00aeef">
    <meta http-equiv="Content-Language" content="pt">

    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title>
        
        Manual de Integração - v4 &middot; Documentações e tutoriais
        
    </title>

    <link rel="shortcut icon" href="https://developercielo.github.io/assets/favicon.ico">

    <!-- CSS -->
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,500" rel="stylesheet" media="none" onload="if(media!='all')media='all'">
    <script async src="https://use.fontawesome.com/3ae06f1030.js"></script>

    <link rel="stylesheet" href="https://developercielo.github.io/assets/bundles/css/bundle.min.css">

    
        
            <link rel="alternate" hreflang="pt" href="https://developercielo.github.io/manual/qrcode-v4" />
        
    
        
            <link rel="alternate" hreflang="en" href="https://developercielo.github.io/en/manual/qrcode-v4" />
        
    

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://developercielo.github.io/atom.xml">
</head>

    <body>
        
        <div class="content-container no-dark-box">
        
            <div id="submenu">
                <div class="submenu-container">
                    <div class="submenu-row sub-items">
                        <div class="submenu-itens">
                            <a href="https://devcielo.zendesk.com/hc/pt-br#suporte" class="help">Ajuda</a>

                            
                            <div class="lang">
                                <span>Idiomas</span>

                                
                                    
                                    <a href="https://developercielo.github.io/manual/qrcode-v4">
                                    

                                        <img alt="Português" src="https://developercielo.github.io/assets/images/pt.png"/>
                                    </a>
                                
                                    
                                    <a href="https://developercielo.github.io/en/manual/qrcode-v4">
                                    

                                        <img alt="English" src="https://developercielo.github.io/assets/images/en.png"/>
                                    </a>
                                
                            </div>
                            
                        </div>

                        
                        <div class="search">
                            <input type="text" class="search" id="input-search">
                        </div>
                    </div>
                    <div class="submenu-row results">
                        <div class="search-results-container">
                            <ul class="search-results"></ul>
                        </div>
                    </div>
                        

                    <div class="submenu-row breads">
                        <ol class="breadcrumb">
                            
                            <li><a href="/">Início</a></li>
                            
                            
                            
                            
                                
                                    
                                    
                                    
                                    
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                            
                                
                                    
                                    <li class="active">&gt; <a href="https://developercielo.github.io/manual/qrcode-v4">Manual de Integração - v4</a></li>
                                    
                                
                            
                        </ol>
                    </div>
                </div>
            </div>

            <div class="post">
  <h1 id="ambientes">Ambientes</h1>

<h2 id="homologação">Homologação</h2>

<table>
  <thead>
    <tr>
      <th>Ambiente</th>
      <th>Endereço</th>
      <th>Descrição</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Homologação</td>
      <td>api2.cielo.com.br/sandbox</td>
      <td>Deve ser utilizado como o ambiente de desenvolvimento/testes de parceiro.</td>
    </tr>
    <tr>
      <td>Homologação</td>
      <td>api2.cielo.com.br/sandbox/v2/oauth/token</td>
      <td>(formato url encoded)</td>
    </tr>
    <tr>
      <td>Homologação</td>
      <td>api2.cielo.com.br/sandbox/v2/oauth/access-token</td>
      <td>(formato json)</td>
    </tr>
    <tr>
      <td>Homologação</td>
      <td>api2.cielo.com.br/sandbox/padraoq/v1/publicKey</td>
      <td>chave pública da criptografia</td>
    </tr>
    <tr>
      <td>Homologação</td>
      <td>api2.cielo.com.br/sandbox/padraoq/v1/parsedQRCode</td>
      <td>Uso opcional</td>
    </tr>
    <tr>
      <td>Homologação</td>
      <td>api2.cielo.com.br/sandbox/padraoq/v1/payment/card</td>
      <td>Recurso para efetuar o pagamento</td>
    </tr>
  </tbody>
</table>

<h2 id="produção">Produção</h2>

<table>
  <thead>
    <tr>
      <th>Ambiente</th>
      <th>Endereço</th>
      <th>Descrição</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Produção</td>
      <td>api2.cielo.com.br</td>
      <td>Deve-se utilizar quando portar as credenciais de produção e um bom nível de maturidade com o ambiente de homologação.</td>
    </tr>
    <tr>
      <td>Produção</td>
      <td>api2.cielo.com.br/v2/oauth/token</td>
      <td>(formato url encoded)</td>
    </tr>
    <tr>
      <td>Produção</td>
      <td>api2.cielo.com.br/v2/oauth/access-token</td>
      <td>(formato json)</td>
    </tr>
    <tr>
      <td>Produção</td>
      <td>api2.cielo.com.br/padraoq/v1/publicKey</td>
      <td>chave pública da criptografia</td>
    </tr>
    <tr>
      <td>Produção</td>
      <td>api2.cielo.com.br/padraoq/v1/parsedQRCode</td>
      <td>Uso opcional</td>
    </tr>
    <tr>
      <td>Produção</td>
      <td>api2.cielo.com.br/padraoq/v1/payment/card</td>
      <td>Recurso para efetuar o pagamento</td>
    </tr>
  </tbody>
</table>

<h1 id="requerimentos-para-acesso">Requerimentos para acesso</h1>

<p>Para a utilização de nossas APIs precisamos receber as seguintes informações, para a criação do cliente id e Authorization.</p>

<ul>
  <li>Nome</li>
  <li>E-mail</li>
  <li>Função</li>
  <li>Quem será o responsável pela integração (Responsável Técnico) para cadastro no API Suite?</li>
</ul>

<p><strong>Informações que enviaremos</strong>:</p>

<p>Após o envio das informações acima, enviaremos ao responsável o client_id (chave que identifica a APP) e o client_secret.</p>

<p>Qualquer dúvida, abra um ticket via <a href="https://devcielo.zendesk.com/hc/pt-br/requests/new?ticket_form_id=360000330511">Zendesk</a></p>

<h1 id="autenticação">Autenticação</h1>

<h2 id="fluxo-de-geração-do-access-token-via-format-json">Fluxo de geração do Access Token (via format JSON)</h2>

<p>O recurso <strong>access_token</strong> é responsável pela autenticação utilizando protocolo OAuth 2.0. Com o client_id e client_secret em mãos a requisição ao <strong>POST /access_token</strong> deve ser feita portando o <strong>authorization</strong> no <strong>Header</strong> e o <strong>grant_type</strong> no corpo da requisição, segue exemplo abaixo.</p>

<p><strong>Nota: O valor do authorization deve ser composto da palavra Basic com o Base64 gerado a partir da concatenação do client_id:client_secret</strong></p>

<h3 id="contrato">Contrato</h3>

<blockquote>
  <p><strong>POST</strong> /v2/oauth/access-token (formato json)</p>

  <p><strong>Headers</strong></p>

  <table>
    <thead>
      <tr>
        <th>Key</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Authorization</strong></td>
        <td>Basic + Base64</td>
      </tr>
      <tr>
        <td><strong>Content-Type</strong></td>
        <td>application-json</td>
      </tr>
    </tbody>
  </table>

  <p><strong>Body</strong></p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
"grant_type": "client_credentials"
}
</code></pre></div>  </div>
</blockquote>

<h4 id="exemplo-de-requisição">Exemplo de Requisição</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl --location --request POST 'https://api2.cielo.com.br/v2/oauth/access-token' \
--header 'Authorization: Basic
dERxQUs000FoSDg5dFdpUWM1ejY0REJKc2lJTFpLbzh4TG0zV0p3eHkwRkQ0Y2dZVm46ZVZUVVZJZjFZWDJkOU40M0p4MVZwNGlWVXEzTzluTTR0TGF1UzhZYWo0V1JPcTJFSXU=' \
--header 'Content-Type: application/json' \
--data-raw '{
 "grant_type": "client_credentials",
"scopes": "qrcode_write,qrcode_read"
}

</code></pre></div></div>

<h4 id="exemplo-de-resposta">Exemplo de Resposta</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "access_token": "5eb50e6b-2bfc-3a44-b9ba-b9ba75256e7e",
  "token_type": "bearer",
  "expires_in": 86400
}
</code></pre></div></div>

<h2 id="fluxo-de-geração-do-access-token-via-format-x-www-form-urlencoded">Fluxo de geração do Access Token (via format x-www-form-urlencoded)</h2>

<blockquote>
  <p><strong>POST</strong> /v2/oauth/token (formato url encoded)</p>

  <p><strong>Headers</strong></p>

  <table>
    <thead>
      <tr>
        <th>Key</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Authorization</strong></td>
        <td>Basic + Base64</td>
      </tr>
      <tr>
        <td><strong>Content-Type</strong></td>
        <td>application-json</td>
      </tr>
    </tbody>
  </table>

  <p><strong>Body</strong></p>

  <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
"grant_type": "client_credentials"
}
</code></pre></div>  </div>
</blockquote>

<h4 id="exemplo-de-requisição-1">Exemplo de Requisição</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl --location --request POST 'https://api2.cielo.com.br/sandbox/v2/oauth/token' \
--header 'Authorization: Basic
dERxQUs0anFoSDg5dFdpUWM1ejY0REJKc2lJTFpLbzh4TG0zV0p3eHkwRkQ0Y2dZVm46
ZVZUVVZJZjFZWDJkOU40M0p4MVZwNGlWVXEzTzluTTR0TGF1UzhZYWo0V1JPcTJFSXU
=' \
--header 'Content-Type: application/json' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'grant_type=client_credentials' \
--data-urlencode 'scopes=qrcode_write,qrcode_read'
</code></pre></div></div>

<h4 id="exemplo-de-resposta-1">Exemplo de Resposta</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
"access_token": "8d9529bd-3dcf-3130-82ea-d28712f96de2",
"token_type": "bearer",
"expires_in": 86400
}
</code></pre></div></div>

<h1 id="códigos-de-retorno-da-api">Códigos de retorno da API</h1>

<p><strong>SUCESSO</strong></p>

<blockquote>
  <table>
    <thead>
      <tr>
        <th>Code</th>
        <th>Nome</th>
        <th>Descrição</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>200</td>
        <td>Ok</td>
        <td>A solicitação foi bem sucedida para uma chamada da API, seja GET OU POST .</td>
      </tr>
      <tr>
        <td>201</td>
        <td>Created</td>
        <td>A solicitação de criação foi bem sucedida para uma chamada da API do tipo POST</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<p><strong>EXCEÇÕES</strong></p>

<blockquote>
  <table>
    <thead>
      <tr>
        <th>Code</th>
        <th>Nome</th>
        <th>Descrição</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>400</td>
        <td>Bad Request.</td>
        <td>* A requisição não é valida. Uma ou mais condições dos campos do request não foram atendidas<br />Lista das condições não atendidas</td>
      </tr>
      <tr>
        <td>401</td>
        <td>Unauthorized</td>
        <td>Falha na Autenticação do consumidor da API</td>
      </tr>
      <tr>
        <td>403</td>
        <td>Forbbiden</td>
        <td>Consumidor da API não possui acesso a determinados recursos</td>
      </tr>
      <tr>
        <td>409</td>
        <td>Conflict</td>
        <td>Reenvio da solicitação com informações divergentes. (Ex: Solicitação de pagamentos com CPF distintos)</td>
      </tr>
      <tr>
        <td>412</td>
        <td>Precondition Failed</td>
        <td>001: Chave expirada<br />002: QRCode dinâmico esperado</td>
      </tr>
      <tr>
        <td>422</td>
        <td>Unprocessable Entity</td>
        <td>A requisição é valida, porém não foi possivel realizar o processamento.</td>
      </tr>
      <tr>
        <td>500</td>
        <td>Internal Server Error</td>
        <td>Erro interno da aplicação. Normalmente provinientes de infraestrutura</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h1 id="geração-da-chave-pública">Geração da chave pública</h1>

<p>O parceiro precisa chamar a API/publicKey para obter a chave pública necessária para o envio  dos dados do cartão de forma criptografada.</p>

<h2 id="contrato-1">Contrato</h2>

<blockquote>
  <p><strong>GET</strong> /padraoq/v1/publicKey</p>

  <p><strong>Headers</strong></p>

  <table>
    <thead>
      <tr>
        <th>Key</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Authorization</strong></td>
        <td>Bearer = access_token  (gerado pela API de Access Token)</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h3 id="exemplo-de-requisição-2">Exemplo de Requisição</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
curl --location --request GET 'https://api2.cielo.com.br/sandbox/padraoq/v1/publicKey' \
--header 'Authorization: Bearer 83247803-585d-379d-8ea4-19dfcf4c3f75'

</code></pre></div></div>

<h3 id="exemplo-de-resposta-2">Exemplo de Resposta</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{
    "public_key": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmH7eS0n6yQSylMDZnY3c/mbDUUEJfyslrilslJKpDRG3m2YaCZdtwo5LahEUWshhBc8jckRkCyqDVVfBJ7WQN1Z1hN0ifCK8mfnh/2SAYGc4e8qydcWT64AVQo+Kay201cRuHeCt1Iyuhi5tOxTF2satd40+8eMkqiVJdhJ0Sjc1ZRezFSo96XReiT8eYz/4Rhubq1BPISlNXqqls3NuPMCxY6IFOLmjTi3xEIdcYtUT5MCfXBG4Rz6rMNrQ7JRAfEOIdvcAt++ygV9ilUxtETn+OKKNDcEUKzXM3Taop8vFXD8HWKzfmlA/usxeKxiI6eTrcWCmrVMQ2Yvf4RSU4wIDAQAB",
    "key_id": "1b59934a-7eaa-4f90-a391-585de0ffc550",
    "expires_in": 35853
}

</code></pre></div></div>

<h2 id="criptografia">Criptografia</h2>

<p>Exemplo do código Java para encriptrar o cartão através da chave pública:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import java.security.PublicKey;
import java.util.Base64;
import javax.crypto.Cipher;
public class EncriptCard {
    public String encript(PublicKey key, String cardNumber) {
        try {
            Cipher cipher = Cipher.getInstance("RSA");
            cipher.init(Cipher.ENCRYPT_MODE, key);
            byte[] encryptedBytes =
                cipher.doFinal(cardNumber.getBytes());
            String encryptedCard =
                Base64.getEncoder().encodeToString(encryptedBytes);
            return encryptedCard;
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}
</code></pre></div></div>

</div>


            <div class="footer-conteudo">
    <div id="footer-conteudo-img" class="col-lg-1 col-md-1">
            <img src="https://developercielo.github.io/assets/images/icon-doubt.svg" width="55px" height="53px" alt="Precisa de ajuda?">
    </div>

    <div id="footer-conteudo-texto" class="col-lg-11 col-md-11">
        <h2>Precisa de ajuda?</h2>
        <p>Se você não conseguiu encontrar sua resposta acima, <a href="https://devcielo.zendesk.com/hc/pt-br#suporte">entre em contato conosco</a>.</p>
    </div>
</div>

        </div>

        <div class="sidebar">
  <div class="sidebar-sticky">
    <div class="sidebar-about">
      <a title="Comutar a coluna da esquerda" class="hamburger">
        <i class="fa fa-bars hamb-menu" aria-hidden="true"></i>
      </a>
      <a href="https://desenvolvedores.cielo.com.br" target="_blank">
        <img src="https://developercielo.github.io/assets/images/logo.png" alt="Documentações e tutoriais" style="width: 60%; margin-left: 20%">
      </a>
      <div></div>
    </div>

    <div id="toc"></div>

    <div class="fixed-footer">
        

    <div class="toc-contact">
      <div class="contact">
        <a title="Contato" href="#">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          <span>Contato</span>
        </a>
      </div>
      <div class="github">
        <a title="GitHub" href="https://github.com/developercielo">
          <i class="fa fa-github" aria-hidden="true"></i>
          <span>GitHub</span>
        </a>
      </div>
    </div>
  </div>
  </div>
</div>


        <script src="https://developercielo.github.io/assets/bundles/js/bundle.min.js"></script>
        <script>
            
            var selectors = 'h1,h2,h3,h4,h5,h6';
            
        </script>

        
        <script src="https://developercielo.github.io/assets/bundles/js/search.min.js"></script>
        

        

        <!-- Hotjar Tracking Code for https://developercielo.github.io/ -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:674586,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>

    </body>
</html>
