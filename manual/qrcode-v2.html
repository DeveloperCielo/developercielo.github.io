<!DOCTYPE html>
<html lang="pt">
    <head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="theme-color" content="#00aeef">
    <meta http-equiv="Content-Language" content="pt">

    <!-- Enable responsiveness on mobile devices-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <title>
        
        Manual de Integração - v2 &middot; Documentações e tutoriais
        
    </title>

    <link rel="shortcut icon" href="https://developercielo.github.io/assets/favicon.ico">

    <!-- CSS -->
    <link href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,500" rel="stylesheet" media="none" onload="if(media!='all')media='all'">
    <script async src="https://use.fontawesome.com/3ae06f1030.js"></script>

    <link rel="stylesheet" href="https://developercielo.github.io/assets/bundles/css/bundle.min.css">

    
        
            <link rel="alternate" hreflang="pt" href="https://developercielo.github.io/manual/qrcode-v2" />
        
    
        
            <link rel="alternate" hreflang="en" href="https://developercielo.github.io/en/manual/qrcode-v2" />
        
    

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="https://developercielo.github.io/atom.xml">
</head>

    <body>
        
        <div class="content-container no-dark-box">
        
            <div id="submenu">
                <div class="submenu-container">
                    <div class="submenu-row sub-items">
                        <div class="submenu-itens">
                            <a href="https://devcielo.zendesk.com/hc/pt-br#suporte" class="help">Ajuda</a>

                            
                            <div class="lang">
                                <span>Idiomas</span>

                                
                                    
                                    <a href="https://developercielo.github.io/manual/qrcode-v2">
                                    

                                        <img alt="Português" src="https://developercielo.github.io/assets/images/pt.png"/>
                                    </a>
                                
                                    
                                    <a href="https://developercielo.github.io/en/manual/qrcode-v2">
                                    

                                        <img alt="English" src="https://developercielo.github.io/assets/images/en.png"/>
                                    </a>
                                
                            </div>
                            
                        </div>

                        
                        <div class="search">
                            <input type="text" class="search" id="input-search">
                        </div>
                    </div>
                    <div class="submenu-row results">
                        <div class="search-results-container">
                            <ul class="search-results"></ul>
                        </div>
                    </div>
                        

                    <div class="submenu-row breads">
                        <ol class="breadcrumb">
                            
                            <li><a href="/">Início</a></li>
                            
                            
                            
                            
                                
                                    
                                    
                                    
                                    
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                
                            
                                
                                    
                                    <li class="active">&gt; <a href="https://developercielo.github.io/manual/qrcode-v2">Manual de Integração - v2</a></li>
                                    
                                
                            
                        </ol>
                    </div>
                </div>
            </div>

            <div class="post">
  <h1 id="requerimentos-para-acesso">Requerimentos para acesso</h1>

<p>Para acesso a APIs é necessário abrir um ticket via <a href="https://devcielo.zendesk.com/hc/pt-br/requests/new?ticket_form_id=360000330511">Zendesk</a>, informando o nome do responsável técnico, e-mail, nome, função e qual o aplicativo que realizará a integração.</p>

<h1 id="macro-fluxo-de-integração">Macro fluxo de integração</h1>

<p>Atualmente dentro da API de pagamentos existem três recursos utilizados para a integração, sendo eles:</p>

<ul>
  <li><strong>POST</strong> /v2/oauth/access-token</li>
  <li><strong>GET</strong> /padraoq/v1/publicKey</li>
  <li><strong>POST</strong> /padraoq/v1/payment/card</li>
</ul>

<p><img src="https://desenvolvedores.cielo.com.br/api-portal/sites/default/files/images/fluxoIntegracao.png" alt="Fluxo de Integração QR Code" /></p>

<h3 id="ambientes">Ambientes</h3>

<table>
  <thead>
    <tr>
      <th>Ambiente</th>
      <th>Endereço</th>
      <th>Descrição</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Homologação</td>
      <td>api2.cielo.com.br/sandbox</td>
      <td>Deve ser utilizado como o ambiente de desenvolvimento/testes de parceiro.</td>
    </tr>
    <tr>
      <td>Produção</td>
      <td>api2.cielo.com.br</td>
      <td>Deve-se utilizar quando portar as credenciais de produção e um bom nível de maturidade com o ambiente de homologação.</td>
    </tr>
  </tbody>
</table>

<h3 id="access-token">Access Token</h3>

<p>O recurso <strong>access_token</strong> é responsável pela autenticação utilizando protocolo OAuth 2.0. Com o client_id e client_secret em mãos a requisição ao <strong>POST /access_token</strong> deve ser feita portando o <strong>authorization</strong> no <strong>Header</strong> e o <strong>grant_type</strong> no corpo da requisição, segue exemplo abaixo.</p>

<p><strong>Nota: O valor do authorization deve ser composto da palavra Basic com o Base64 gerado a partir da concatenação do client_id:client_secret</strong></p>

<h4 id="contrato">Contrato</h4>

<blockquote>
  <p><strong>POST</strong> /v2/oauth/token (formato url encoded)</p>

  <p><strong>POST</strong> /v2/oauth/access-token (formato json)</p>

  <p><strong>Headers</strong></p>

  <table>
    <thead>
      <tr>
        <th>Key</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Authorization</strong></td>
        <td>Basic + Base64</td>
      </tr>
      <tr>
        <td><strong>Content-Type</strong></td>
        <td>application-json</td>
      </tr>
    </tbody>
  </table>

  <p><strong>Body</strong></p>

  <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
"grant_type": "client_credentials"
}
</code></pre></div>  </div>
</blockquote>

<h4 id="exemplo-de-requisição">Exemplo de Requisição</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
curl --location --request POST 'https://api2.cielo.com.br/v2/oauth/access-token' \
--header 'Authorization: Basic
dERxQUs000FoSDg5dFdpUWM1ejY0REJKc2lJTFpLbzh4TG0zV0p3eHkwRkQ0Y2dZVm46ZVZUVVZJZjFZWDJkOU40M0p4MVZwNGlWVXEzTzluTTR0TGF1UzhZYWo0V1JPcTJFSXU=' \
--header 'Content-Type: application/json' \
--data-raw '{
 "grant_type": "client_credentials",
"scopes": "qrcode_write,qrcode_read"
}

</code></pre></div></div>

<h4 id="exemplo-de-resposta">Exemplo de Resposta</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{
  "access_token": "5eb50e6b-2bfc-3a44-b9ba-b9ba75256e7e",
  "token_type": "bearer",
  "expires_in": 86400
}

</code></pre></div></div>

<h3 id="public-keys">Public Keys</h3>

<p>Public keys é o recurso responsável por retornar a chave pública da criptografia utilizada para criptografar o número do cartão, que futuramente será enviado no corpo da requisição do recurso <strong>payment/card</strong>. O algoritmo de criptografia utilizada é <strong>RSA de 2048 bits e cifra RSA/ECB/PKCS1Padding</strong>. Para a requisição ao recurso <strong>GET /publicKeys</strong> é necessário o <strong>access_token</strong> que foi gerado no passo anterior.</p>

<h4 id="contrato-1">Contrato</h4>

<blockquote>
  <p><strong>GET</strong> /padraoq/v1/publicKey</p>

  <p><strong>Headers</strong></p>

  <table>
    <thead>
      <tr>
        <th>Key</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Authorization</strong></td>
        <td>Bearer = access_token  (gerado pela API de Access Token)</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<h4 id="exemplo-de-requisição-1">Exemplo de Requisição</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
curl --location --request GET 'https://api2.cielo.com.br/sandbox/padraoq/v1/publicKey' \
--header 'Authorization: Bearer 83247803-585d-379d-8ea4-19dfcf4c3f75'

</code></pre></div></div>

<h4 id="exemplo-de-resposta-1">Exemplo de Resposta</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{
    "public_key": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmH7eS0n6yQSylMDZnY3c/mbDUUEJfyslrilslJKpDRG3m2YaCZdtwo5LahEUWshhBc8jckRkCyqDVVfBJ7WQN1Z1hN0ifCK8mfnh/2SAYGc4e8qydcWT64AVQo+Kay201cRuHeCt1Iyuhi5tOxTF2satd40+8eMkqiVJdhJ0Sjc1ZRezFSo96XReiT8eYz/4Rhubq1BPISlNXqqls3NuPMCxY6IFOLmjTi3xEIdcYtUT5MCfXBG4Rz6rMNrQ7JRAfEOIdvcAt++ygV9ilUxtETn+OKKNDcEUKzXM3Taop8vFXD8HWKzfmlA/usxeKxiI6eTrcWCmrVMQ2Yvf4RSU4wIDAQAB",
    "key_id": "1b59934a-7eaa-4f90-a391-585de0ffc550",
    "expires_in": 35853
}

</code></pre></div></div>

<h3 id="criptografia">Criptografia</h3>

<p>Exemplo de código Java para criptografar o número do cartão usando uma  public key:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import java.security.PublicKey;
import java.util.Base64;
import javax.crypto.Cipher;
public class EncriptCard {
    public String encript(PublicKey key, String cardNumber) {
        try {
            Cipher cipher = Cipher.getInstance("RSA");
            cipher.init(Cipher.ENCRYPT_MODE, key);
            byte[] encryptedBytes =
                cipher.doFinal(cardNumber.getBytes());
            String encryptedCard =
                Base64.getEncoder().encodeToString(encryptedBytes);
            return encryptedCard;
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}
</code></pre></div></div>

<h3 id="payments">Payments</h3>

<p>O recurso <strong>POST /payment/card</strong> é responsável por efetuar o pagamento com base nos dados contidos no payload da requisição. No header da requisição é necessário informar o <strong>Authorization</strong>. 
O corpo da requisição é composto por dados provenientes do aplicativo e do QR Code. <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Verificar seção 3 para os campos extraídos do QR Code</a>.</p>

<h4 id="contrato-2">Contrato</h4>

<blockquote>
  <p><strong>POST</strong> /cielo-payment/v1/payments</p>

  <p><strong>Headers</strong></p>

  <table>
    <thead>
      <tr>
        <th>Key</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Authorization</strong></td>
        <td>Bearer = access_token  (gerado pela API de Access Token)</td>
      </tr>
      <tr>
        <td><strong>Content-Type</strong></td>
        <td>application/json</td>
      </tr>
    </tbody>
  </table>
</blockquote>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
{
    "public_key": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAmH7eS0n6yQSylMDZnY3c/mbDUUEJfyslrilslJKpDRG3m2YaCZdtwo5LahEUWshhBc8jckRkCyqDVVfBJ7WQN1Z1hN0ifCK8mfnh/2SAYGc4e8qydcWT64AVQo+Kay201cRuHeCt1Iyuhi5tOxTF2satd40+8eMkqiVJdhJ0Sjc1ZRezFSo96XReiT8eYz/4Rhubq1BPISlNXqqls3NuPMCxY6IFOLmjTi3xEIdcYtUT5MCfXBG4Rz6rMNrQ7JRAfEOIdvcAt++ygV9ilUxtETn+OKKNDcEUKzXM3Taop8vFXD8HWKzfmlA/usxeKxiI6eTrcWCmrVMQ2Yvf4RSU4wIDAQAB",
    "key_id": "1b59934a-7eaa-4f90-a391-585de0ffc550",
    "expires_in": 35853
}

</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Propriedade</th>
      <th>Descrição</th>
      <th>Tipo</th>
      <th>Tamanho</th>
      <th>Obrigatório</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">technology.type</code></td>
      <td>Enviar “QRCODE” por padrão</td>
      <td>Texto</td>
      <td>6</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">technology.identifier</code></td>
      <td>Identificador da transação. Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Texto alfanumérico</td>
      <td>16</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">operationType.id</code></td>
      <td>Enviar o numeral 1 por padrão</td>
      <td>Número</td>
      <td>1</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">amount</code></td>
      <td>Valor da transação (em ambiente de homologação enviar apenas número inteiros). Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Número</td>
      <td>16</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">paymentInstallments</code></td>
      <td>Número de parcelas. Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Número</td>
      <td>2</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">terminalLogicalNumber</code></td>
      <td>Número lógico do POS. Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Número</td>
      <td>40</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">paymentDate</code></td>
      <td>Data e hora da transação. Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Texto</td>
      <td>30</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">mainProduct.id</code></td>
      <td>Produto matriz. Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Número</td>
      <td>4</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">subProduct.id</code></td>
      <td>Produto secundário. Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Número</td>
      <td>4</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">merchantAccountInformation.id</code></td>
      <td>Número do estabelecimento comercial. Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Número</td>
      <td>10</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">merchantAccountInformation.merchantName</code></td>
      <td>Nome do estabelecimento comercial. Campo proveniente do QRCode, <a href="https://developercielo.github.io/manual/qrcode#d%C3%AA-para-qr-code-x-recurso-payments">Veja layout</a></td>
      <td>Número</td>
      <td>1</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">card.encryptedCardNumber</code></td>
      <td>Número do cartão criptografado, <a href="https://developercielo.github.io/manual/qrcode#public-keys">Veja mais</a></td>
      <td> </td>
      <td> </td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">card.holder</code></td>
      <td>Nome do portador impresso no cartão.</td>
      <td>Número</td>
      <td>25</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">card.expirationDate</code></td>
      <td>Data de validade impresso no cartão.</td>
      <td>Texto</td>
      <td>7</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">card.brand</code></td>
      <td>Bandeira do cartão. Consultar a lista de produtos e bandeiras aceitas no QRCode.</td>
      <td>Texto</td>
      <td>10</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">carrier.name</code></td>
      <td>Nome do usuário do aplicativo.</td>
      <td>Texyo</td>
      <td>255</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">carrier.document</code></td>
      <td>Documento do usuário do aplicativo, exemplo CPF. Enviar apenas número</td>
      <td>Texto</td>
      <td>14</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">carrier.deviceId</code></td>
      <td>Identificador único de cada dispositivo.</td>
      <td> </td>
      <td> </td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">crc.qrCodeText</code></td>
      <td>QRCode do POS</td>
      <td> </td>
      <td> </td>
      <td>Sim</td>
    </tr>
  </tbody>
</table>

<h4 id="exemplo-de-requisição-2">Exemplo de Requisição</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl --request POST \
  --url 'http:///cielo-payment/v1/payments' \
  --header 'Content-Type: application/json' \
  --header 'access_token: ' \
  --header 'client_id: ' \
  --data '{
  "technology":{
     "type":"QRCODE",
     "identifier":"13050329197F190A"
  },
  "operationType":{
     "id":1
  },
  "amount":1,
  "paymentInstallments":01,
  "terminalLogicalNumber":12345,
  "paymentDate":"2018-05-15T11:33:49Z",
  "mainProduct":{
     "id":1000
  },
  "subProduct":{
     "id":1
  },
  "merchantAccountInformation":{
     "id":3456789012,
     "merchantName":"Hotelaria Accor Pdb Ltda"
  },
  "card":{
     "encryptedCardNumber": "KPzccLxuZFavn6FN5XhOsXdF19wrfiOleE0lCMixw+0E79YAVn659vDpKhy/D/EQnRbiKrrfRQYyQeek2cpyd5hiqtwK+4gdfUo8X4NpSYxDdk0n0ru1czg8hWn3Dl6LkQT8K/lOgfTttZQgQsmwPRBzhDImlzIav9E1Uqvzba3WWPrusCgGgE5oEMTGLjcmG1ZZByeXHiDmU5Pd9TomILj4nVFsoOWYtM5PZDn+1FfJ3lDLgND8asUMyLIqyQMZ3iDM6Rrgp/4Yj5082FNO++6ZMW2mPmlr4i2gmFi2sV4QayNuXX34mxrUw1kYpSetNVEL/okGzSaGxbN0O37Fug==",
     "holder":"JOAO DA SILVA",
     "expirationDate":"01/25",
     "brand":"VISA"
  },
  "carrier":{
     "name":"João da Silva",
     "document":"31727721012",
     "deviceId":"3ac43b36-0d92-48a7-901b-d3a527d9c3fe"
  },
  "crc":{
     &gt;"qrCodeText":"00020101021226410005Cielo0116123456789012000102082009130352040000530398654120000000001005802BR5905CIELO6014SANTO ANDRE SP801010033”https://www.cielo.com.br/qrcode”011613050329197F190A0212150518113349030410000404000105020006020163049872"
  }
}
</code></pre></div></div>

<h4 id="exemplo-de-resposta-2">Exemplo de Resposta</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
    "transactionDate": "2018-05-15T11:33:49.000-03:00",
    "terminalLogicalNumber": "12345",
    "authorizationCode": "8888",
    "nsu": "999"
}
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Propriedade</th>
      <th>Descrição</th>
      <th>Tipo</th>
      <th>Tamanho</th>
      <th>Obrigatório</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">transactionDate</code></td>
      <td>Data da transação (extraída do QRCode)</td>
      <td>Texto</td>
      <td>36</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">terminalLogicalNumber</code></td>
      <td>Número lógico do POS</td>
      <td>Texto</td>
      <td>40</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">authorizationCode</code></td>
      <td>Código de autorização da transação</td>
      <td>Texto alfanumérico</td>
      <td>6</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">nsu</code></td>
      <td>Número Sequencial Único</td>
      <td>Texto</td>
      <td>50</td>
      <td>Sim</td>
    </tr>
  </tbody>
</table>

<h1 id="dê-para-qr-code-x-recurso-payments">Dê-para QR Code x Recurso Payments</h1>

<p>Para a composição do payload do <strong>/payments</strong> deve-se mesclar informações provenientes da leitura do QR Code e informações do cartão/portador via aplicativo. Na tabela abaixo é especificado o dê-para dos dados extraídos do QR Code para o payload da requisição.</p>

<blockquote>
  <p>Para mais informações dos campos provenientes do QR Code verificar o próximo item.</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>QR Code</th>
      <th>Recurso Payment</th>
      <th>Obrigatório</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>TransactionID</td>
      <td>Technology.Identifier</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Transaction Amount</td>
      <td>Amount</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Payment Installments</td>
      <td>PaymentInstallments</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Logic Number</td>
      <td>TerminalLogicalNumber</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Transaction Date</td>
      <td>PaymentDate</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Main Product</td>
      <td>MainProduct.Id</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Sub Product</td>
      <td>SubProduct.Id</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Merchant Account Information</td>
      <td>MerchantAccountInformation.Id</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Merchant Name</td>
      <td>MerchantAccountInformation.Name</td>
      <td>Sim</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>Nota: O campo MerchantAccountInformation.Id tem o tamanho máximo de 10 posições, ao extrair a informação referente no QR Code descontar os dois primeiros e os quatros últimos dígitos.</p>
</blockquote>

<h2 id="layout-do-qr-code-gerado-pelo-pos">Layout do QR Code gerado pelo POS</h2>

<p>Atualmente o POS cria o QR Code a partir das informações especificadas abaixo com base na especificação “<strong>EMVCo-Merchant-Presented-QR-Specification-v1</strong>”.</p>

<p><img src="https://desenvolvedores.cielo.com.br/api-portal/sites/default/files/images/layout_qrcode_.png" alt="Layout QRCode" /></p>

<p>Os campos destacados e identificamos abaixo são provenientes da análise do QR Code. O ID do campo e seu tamanho são sempre enviados antes do valor correspondente.</p>

<p><img src="https://desenvolvedores.cielo.com.br/api-portal/sites/default/files/images/layout-qr-code.png" alt="Layout QRCode" /></p>

<h1 id="como-testar">Como Testar</h1>

<p>Atualmente existem duas possibilidades para testar o fluxo de pagamento no ambiente de homologação.</p>

<h3 id="via-qr-code">Via QR Code</h3>

<p>Caso não esteja com o POS de homologação em mãos, a maneira mais rápida para teste é utilizando o QR Code abaixo.</p>

<blockquote>
  <p>Posicional de exemplo:</p>

  <p>“00020101021226410005Cielo0116123456789012000102082009130352040000530398654120000000001005802BR5905CIELO6014SANTO ANDRE SP801010033”https://www.cielo.com.br/qrcode”011613050329197F190A0212150518113349030410000404000105020006020163049872”</p>

  <p>QR Code gerado a partir do código de exemplo:</p>

  <p><img src="https://desenvolvedores.cielo.com.br/api-portal/sites/default/files/images/qro-code-exemplo.png" alt="QR Code gerado a partir do código de exemplo:" />
Observação: Ao testar com o QR Code especificado um erro do tipo 422 é esperado, pois, não existe dados transacionais referentes no autorizador da Cielo.</p>
</blockquote>

<h1 id="como-obter-o-pos-de-homologação">Como obter o POS de homologação.</h1>

<p>Para a obtenção do POS de homologação deve-se abrir chamado via <a href="https://devcielo.zendesk.com/hc/pt-br/requests/new?ticket_form_id=360000324432">Zendesk</a>.</p>

<h1 id="api-de-callback-desfazimento">API de Callback (desfazimento)</h1>

<p>Existe uma API de callback para enviar informações sobre as transações de desfazimento, que pode ocorrer no fluxo de transações entre o POS e a plataforma do sistema de autorização.</p>

<p>Será necessário com que o parceiro desenvolva uma API de retorno de chamada para receber as informações sobre aa transações de desfazimento e encaminhar a URL(endpoint)  para nossa equipe através do Zendesk. Lembrando que a API de Callback deve ser gerada no formato restfull.</p>

<h2 id="requisição">Requisição</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{  
   "transactionDate": "2018-10-29T14:35:12.000+0000",
   "terminalLogicalNumber": "78257509",
   "authorizationCode": "019387",
   "nsu": "572061",
   "merchantId": 1000000000,
   "amount": 82.90,
   "originalTransactionType": 1,
   "statusCode": 3
}
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>Propriedade</th>
      <th>Descrição</th>
      <th>Tipo</th>
      <th>Tamanho</th>
      <th>Obrigatório</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">transactionDate</code></td>
      <td>Data da transação (extraída do QRCode)</td>
      <td>Texto</td>
      <td>36</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">terminalLogicalNumber</code></td>
      <td>Número lógico do POS</td>
      <td>Texto</td>
      <td>40</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">authorizationCode</code></td>
      <td>Código de autorização da transação</td>
      <td>Texto alfanumérico</td>
      <td>6</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">nsu</code></td>
      <td>Número Sequencial Único</td>
      <td>Texto</td>
      <td>50</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">merchantId</code></td>
      <td>Identificador da loja na Cielo (extraído do QRCode)</td>
      <td>Número</td>
      <td>36</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">amount</code></td>
      <td>Valor da transação</td>
      <td>Número</td>
      <td>15</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">originalTransactionType</code></td>
      <td>Transação de origem. Comunica o desfazimento de uma transação do /payments.</td>
      <td>Número</td>
      <td>1</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">statusCode</code></td>
      <td>1 - Pagamento / 2 - Cancelamento / 3 - Desfazimento - Quando desfazimento - statusCode = 3</td>
      <td>Número</td>
      <td>1</td>
      <td>Sim</td>
    </tr>
  </tbody>
</table>

<h1 id="bandeiras-e-formas-de-parcelamento">Bandeiras e Formas de Parcelamento</h1>

<p>A versão atual da API de QRCode possui suporte às seguintes bandeiras e formas de parcelamento:</p>

<table>
  <thead>
    <tr>
      <th>Bandeira</th>
      <th>À vista</th>
      <th>Parcelado Loja</th>
      <th>Parcelado Emissor</th>
      <th>Parcelado Cliente</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Visa</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Mastercard</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>Elo</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
    </tr>
    <tr>
      <td>American Express</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
      <td><em>Não</em></td>
    </tr>
    <tr>
      <td>Diners Club</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
      <td><em>Não</em></td>
    </tr>
    <tr>
      <td>JCB</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
      <td><em>Não</em></td>
    </tr>
    <tr>
      <td>Banescard</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
      <td><em>Não</em></td>
    </tr>
    <tr>
      <td>Hipercard</td>
      <td>Sim</td>
      <td>Sim</td>
      <td>Sim</td>
      <td><em>Não</em></td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p>Cartões emitidos no exterior não possuem permissão de parcelamento.   <br />
A solução de pagamento QR Code Cielo atualmente não aceita pagamentos no débito.</p>
</blockquote>

<h1 id="códigos-da-api">Códigos da API</h1>

<h2 id="erros-da-api">Erros da API</h2>

<table>
  <thead>
    <tr>
      <th>Código</th>
      <th>Descrição</th>
      <th>Modelo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>201</td>
      <td>Created</td>
      <td> </td>
    </tr>
    <tr>
      <td>400</td>
      <td>Bad Request.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
    <tr>
      <td>401</td>
      <td>Unauthorized.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
    <tr>
      <td>403</td>
      <td>Forbidden.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
    <tr>
      <td>404</td>
      <td>Not Found.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
    <tr>
      <td>412</td>
      <td>Precondition Failed.</td>
      <td>{“properties”:{“code”:{“type”:”string”,”description”:”Error code.”},”description”:{“type”:”string”,”description”:”Error full description.”}}}</td>
    </tr>
    <tr>
      <td>413</td>
      <td>Request Entity Too Large.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
    <tr>
      <td>415</td>
      <td>Unsupported Media Type.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
    <tr>
      <td>422</td>
      <td>Unprocessable Entity.</td>
      <td>{“properties”:{“code”:{“type”:”string”,”description”:”Error code.”},”description”:{“type”:”string”,”description”:”Error full description.”}}}</td>
    </tr>
    <tr>
      <td>429</td>
      <td>Too Many Requests.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
    <tr>
      <td>500</td>
      <td>Internal Server Error.</td>
      <td>{“properties”:{“code”:{“type”:”string”,”description”:”Error code.”},”description”:{“type”:”string”,”description”:”Error full description.”}}}</td>
    </tr>
    <tr>
      <td>502</td>
      <td>Bad Gateway.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
    <tr>
      <td>504</td>
      <td>Gateway Timeout.</td>
      <td>{“description”:”Error full description.”,”type”:”string”}</td>
    </tr>
  </tbody>
</table>

<h2 id="erros-de-pagamento">Erros de Pagamento</h2>

<table>
  <tbody>
    <tr>
      <td>Código</td>
      <td>Mensagem</td>
    </tr>
    <tr>
      <td>412.001</td>
      <td>Não foi informado o NSU.</td>
    </tr>
    <tr>
      <td>412.002</td>
      <td>Não foi informado o CAVV.</td>
    </tr>
    <tr>
      <td>412.003</td>
      <td>O tipo de tecnologia utilizado no pagamento não foi informado.</td>
    </tr>
    <tr>
      <td>412.004</td>
      <td>O tipo de operação para o pagamento não foi informado.</td>
    </tr>
    <tr>
      <td>412.005</td>
      <td>Valor do pagamento não foi informado.</td>
    </tr>
    <tr>
      <td>412.006</td>
      <td>O número de parcelas não foi informado.</td>
    </tr>
    <tr>
      <td>412.007</td>
      <td>A data de pagamento não foi informado.</td>
    </tr>
    <tr>
      <td>412.008</td>
      <td>O código do produto primário não foi informado.</td>
    </tr>
    <tr>
      <td>412.009</td>
      <td>O código do produto secundário não foi informado.</td>
    </tr>
    <tr>
      <td>412.010</td>
      <td>O código do estabelecimento comercial não foi informado.</td>
    </tr>
    <tr>
      <td>412.011</td>
      <td>O nome do estabelecimento comercial não foi informado.</td>
    </tr>
    <tr>
      <td>412.012</td>
      <td>O número do código não foi informado.</td>
    </tr>
    <tr>
      <td>412.013</td>
      <td>O CPF do portador não foi informado.</td>
    </tr>
    <tr>
      <td>412.014</td>
      <td>O nome do portador não foi informado.</td>
    </tr>
    <tr>
      <td>412.015</td>
      <td>Device ID do aparelho celular não foi informado.</td>
    </tr>
    <tr>
      <td>412.016</td>
      <td>O identificador da tecnologia utilizado no pagamento não foi informado.</td>
    </tr>
    <tr>
      <td>412.017</td>
      <td>O status não foi informado.</td>
    </tr>
    <tr>
      <td>412.018</td>
      <td>A data de validade do código não foi informado.</td>
    </tr>
    <tr>
      <td>412.019</td>
      <td>O número do terminal lógico não foi informado.</td>
    </tr>
    <tr>
      <td>412.023</td>
      <td>O código pagamento não foi informado.</td>
    </tr>
    <tr>
      <td>412.024</td>
      <td>A bandeira do código não foi informada.</td>
    </tr>
    <tr>
      <td>412.025</td>
      <td>O titular do código não foi informado.</td>
    </tr>
    <tr>
      <td>412.028</td>
      <td>O tamanho máximo é de 10 caracteres para o estabelecimento comercial.</td>
    </tr>
    <tr>
      <td>412.029</td>
      <td>O tamanho máximo é de 70 caracteres para o nome do estabelecimento comercial.</td>
    </tr>
    <tr>
      <td>412.030</td>
      <td>O tamanho máximo é de 11 caracteres para o CPF do portador.</td>
    </tr>
    <tr>
      <td>412.031</td>
      <td>O tamanho máximo é de 50 caracteres para o nome do portador.</td>
    </tr>
    <tr>
      <td>412.032</td>
      <td>O tamanho máximo é de 8 caracteres para o terminal lógico.</td>
    </tr>
    <tr>
      <td>412.033</td>
      <td>O id do cartão não foi informado.</td>
    </tr>
    <tr>
      <td>412.034</td>
      <td>O id do carrier não foi informado.</td>
    </tr>
    <tr>
      <td>412.035</td>
      <td>O nome do portador no cartão não pode conter caracteres especiais.</td>
    </tr>
    <tr>
      <td>412.036</td>
      <td>O documento não foi informado.</td>
    </tr>
    <tr>
      <td>412.037</td>
      <td>A senha não foi informada.</td>
    </tr>
    <tr>
      <td>412.038</td>
      <td>O QR CodeTM informado não é válido.</td>
    </tr>
    <tr>
      <td>412.039</td>
      <td>O QR CodeTM não foi informado.</td>
    </tr>
    <tr>
      <td>422.001</td>
      <td>O produto primário não foi encontrado.</td>
    </tr>
    <tr>
      <td>422.002</td>
      <td>O produto secundário não foi encontrado.</td>
    </tr>
    <tr>
      <td>422.003</td>
      <td>A carteira digital não foi encontrada.</td>
    </tr>
    <tr>
      <td>422.004</td>
      <td>O tipo de tecnologia não foi encontrado.</td>
    </tr>
    <tr>
      <td>422.005</td>
      <td>O tipo de operação não foi encontrado.</td>
    </tr>
    <tr>
      <td>422.006</td>
      <td>Falha ao detokenizar o cartão.</td>
    </tr>
    <tr>
      <td>422.007</td>
      <td>Este cartão não pode ser utilizado.</td>
    </tr>
    <tr>
      <td>422.008</td>
      <td>Este cartão informado não foi positivado.</td>
    </tr>
    <tr>
      <td>422.009</td>
      <td>Este cartão informado não foi tokenizado.</td>
    </tr>
    <tr>
      <td>422.010</td>
      <td>Não foi possível autenticar o portador com os dados informados.</td>
    </tr>
    <tr>
      <td>422.011</td>
      <td>Transação não encontrada no Autorizador.</td>
    </tr>
    <tr>
      <td>422.012</td>
      <td>Falha ao enviar dados ao Autorizador.</td>
    </tr>
    <tr>
      <td>422.013</td>
      <td><strong>**</strong> Mensagem retornada do Autorizador <strong>**</strong></td>
    </tr>
    <tr>
      <td>422.014</td>
      <td>Você errou o login/senha mais de 3 vezes. Seu usuário foi bloqueado, utilize esqueci minha senha para desbloquear.</td>
    </tr>
    <tr>
      <td>422.017</td>
      <td>Ainda não aceitamos pagamentos com este cartão cadastrado.</td>
    </tr>
    <tr>
      <td>422.018</td>
      <td>O usuário do pagamento não é o mesmo do login.</td>
    </tr>
    <tr>
      <td>422.019</td>
      <td>Erro ao aplicar descriptografia.</td>
    </tr>
    <tr>
      <td>422.020</td>
      <td>A string do cartão criptografado não está em um formato válido.</td>
    </tr>
    <tr>
      <td>422.021</td>
      <td>QR Code expirado. Solicite a geração de um novo QR Code.</td>
    </tr>
    <tr>
      <td>422.022</td>
      <td>Erro ao obter chave pública.</td>
    </tr>
    <tr>
      <td>422.023</td>
      <td>Erro ao aplicar criptografia.</td>
    </tr>
    <tr>
      <td>422.024</td>
      <td>Erro ao obter chave privada.</td>
    </tr>
  </tbody>
</table>

<h1 id="dúvidas-frequentes">Dúvidas Frequentes</h1>

<ul>
  <li>
    <p><strong>Os testes devem ser feitos direto no ambiente de Homologação?</strong>
R: Sim, infelizmente hoje não temos ambiente de desenvolvimento.</p>
  </li>
  <li>
    <p><strong>Qual o processo para adquirir as credenciais de Produção?</strong>
R: Vide seção 1.</p>
  </li>
  <li>
    <p><strong>Qual criptografia é utilizada para criptografar o cartão?</strong>
R: Vide seção 2.1.</p>
  </li>
  <li>
    <p><strong>A solução de pagamento QR Code Cielo atualmente aceita pagamentos no débito?</strong>
R: Não.</p>
  </li>
  <li>
    <p><strong>O que seria o campo deviceID?</strong>
R: Identificador único de cada dispositivo. Segue IOS: https://developer.apple.com/documentation/uikit/uidevice/1620059-identifierforvendor, Android: https://developer.android.com/training/articles/user-data-ids.</p>
  </li>
</ul>

<h1 id="canal-de-suporte-a-dúvidas">Canal de Suporte a Dúvidas</h1>

<p>Caso ainda tenha dúvidas deve-se abrir um chamado via <a href="https://devcielo.zendesk.com/hc/pt-br/requests/new?ticket_form_id=360000316152">Zendesk</a>.</p>

</div>


            <div class="footer-conteudo">
    <div id="footer-conteudo-img" class="col-lg-1 col-md-1">
            <img src="https://developercielo.github.io/assets/images/icon-doubt.svg" width="55px" height="53px" alt="Precisa de ajuda?">
    </div>

    <div id="footer-conteudo-texto" class="col-lg-11 col-md-11">
        <h2>Precisa de ajuda?</h2>
        <p>Se você não conseguiu encontrar sua resposta acima, <a href="https://devcielo.zendesk.com/hc/pt-br#suporte">entre em contato conosco</a>.</p>
    </div>
</div>

        </div>

        <div class="sidebar">
  <div class="sidebar-sticky">
    <div class="sidebar-about">
      <a title="Comutar a coluna da esquerda" class="hamburger">
        <i class="fa fa-bars hamb-menu" aria-hidden="true"></i>
      </a>
      <a href="https://desenvolvedores.cielo.com.br" target="_blank">
        <img src="https://developercielo.github.io/assets/images/logo.png" alt="Documentações e tutoriais" style="width: 60%; margin-left: 20%">
      </a>
      <div></div>
    </div>

    <div id="toc"></div>

    <div class="fixed-footer">
        

    <div class="toc-contact">
      <div class="contact">
        <a title="Contato" href="#">
          <i class="fa fa-envelope-o" aria-hidden="true"></i>
          <span>Contato</span>
        </a>
      </div>
      <div class="github">
        <a title="GitHub" href="https://github.com/developercielo">
          <i class="fa fa-github" aria-hidden="true"></i>
          <span>GitHub</span>
        </a>
      </div>
    </div>
  </div>
  </div>
</div>


        <script src="https://developercielo.github.io/assets/bundles/js/bundle.min.js"></script>
        <script>
            
            var selectors = 'h1,h2,h3,h4,h5,h6';
            
        </script>

        
        <script src="https://developercielo.github.io/assets/bundles/js/search.min.js"></script>
        

        

        <!-- Hotjar Tracking Code for https://developercielo.github.io/ -->
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:674586,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>

    </body>
</html>
